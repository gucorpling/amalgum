<?xml version="1.0" ?><text author="Reddit community (see URL)" dateCollected="2019-11-02" dateCreated="2018-05-31" dateModified="2018-05-31" id="autogum_reddit_doc050" shortTile="q-c-support-persistent" sourceURL="http://redd.it/8ni6p4" speakerCount="2" speakerList="#14ned, #OldWolf2" title="Q: How should C++ support persistent memory?" type="reddit">
<head>
<s type="wh">
Q	NN	Q
:	:	:
How	WRB	how
should	MD	should
C++	NNP	C++
support	VB	support
persistent	JJ	persistent
memory	NN	memory
?	.	?
</s>
</head>
<sp who="#14ned">
<p>
<s type="frag">
Optane	NNP	Optane
DDR4	NNP	DDR4
</s>
<s type="decl">
DIMMs	NNS	DIMMs
have	VBP	have
been	VBN	be
announced	VBN	announce
(	-LRB-	(
https://www.anandtech.com/show/12828/intel-launches-optane-dimms-up-to-512gb-apache-pass-is-here	NNP	https://www.anandtech.com/show/12828/intel-launches-optane-dimms-up-to-512gb-apache-pass-is-here
)	-RRB-	)
.	.	.
</s>
<s type="decl">
These	DT	these
fit	VBP	fit
into	IN	into
your	PRP$	your
RAM	NNP	RAM
slots	NNS	slot
,	,	,
and	CC	and
on	IN	on
supporting	VBG	support
motherboards	NNS	motherboard
(	-LRB-	(
i.	FW	i.
e.	FW	e.
none	NNS	none
of	IN	of
the	DT	the
current	JJ	current
ones	NNS	one
)	-RRB-	)
,	,	,
they	PRP	they
can	MD	can
be	VB	be
configured	VBN	configure
in	IN	in
the	DT	the
BIOS	NNP	BIOS
to	TO	to
appear	VB	appear
either	CC	either
as	IN	as
a	DT	a
hard	JJ	hard
drive	NN	drive
,	,	,
or	CC	or
as	IN	as
RAM	NNP	RAM
,	,	,
to	TO	to
your	PRP$	your
system	NN	system
.	.	.
</s>
<s type="decl">
Next	JJ	next
year	NN	year
's	POS	's
motherboards	NNS	motherboard
which	WDT	which
support	VBP	support
PRAM	NNP	PrAM
DIMMs	NNPS	DIMMs
should	MD	should
have	VB	have
sufficient	JJ	sufficient
slots	NNS	slot
for	IN	for
fitting	VBG	fitting
up	RP	up
to	TO	to
64Tb	CD	64Tb
(	-LRB-	(
yes	UH	yes
,	,	,
terabytes	NNS	terabyte
)	-RRB-	)
of	IN	of
DIMMs	NNPS	DIMMs
,	,	,
though	IN	though
these	DT	these
will	MD	will
probably	RB	probably
be	VB	be
server	NN	server
motherboards	NNS	motherboard
.	.	.
</s>
<s type="decl">
Despite	IN	despite
some	DT	some
of	IN	of
the	DT	the
misinformation	NN	misinformation
currently	RB	currently
going	VBG	go
around	RP	around
,	,	,
Optane	NNP	Optane
DIMMs	NNPS	DIMMs
have	VBP	have
a	DT	a
similar	JJ	similar
read	NN	read
latency	NN	latency
to	TO	to
normal	JJ	normal
DDR4	NNP	DDR4
RAM	NNP	RAM
,	,	,
but	CC	but
about	RB	about
double	VB	double
the	DT	the
write	NN	write
latency	NN	latency
.	.	.
</s>
<s type="decl">
Bandwidth	NN	Bandwidth
is	VBZ	be
similar	JJ	similar
to	TO	to
DDR4	NNP	DDR4
RAM	NNP	RAM
i.e.	FW	i.e.
lots	NNS	lot
.	.	.
</s>
<s type="decl">
Unlike	IN	unlike
DRAM	NNP	DRAM
,	,	,
PRAM	NN	PrAM
does	VBZ	do
not	RB	not
require	VB	require
constant	JJ	constant
DRAM	NN	DRAM
refreshes	NNS	refresh
,	,	,
and	CC	and
thus	RB	thus
is	VBZ	be
especially	RB	especially
attractive	JJ	attractive
to	TO	to
power	NN	power
conserving	VBG	conserve
devices	NNS	device
such	JJ	such
as	IN	as
laptops	NNS	laptop
and	CC	and
mobile	JJ	mobile
phones	NNS	phone
.	.	.
</s>
<s type="decl">
The	DT	the
dollars	NNS	dollar
per	IN	per
Gb	NNP	Gb
ratio	NN	ratio
is	VBZ	be
dropping	VBG	drop
faster	JJR	faster
than	IN	than
any	DT	any
other	JJ	other
type	NN	type
of	IN	of
storage	NN	storage
currently	RB	currently
,	,	,
as	RB	as
if	IN	if
trends	NNS	trend
continue	VBP	continue
,	,	,
they	PRP	they
will	MD	will
match	VB	match
the	DT	the
capacity	NN	capacity
per	IN	per
dollar	NN	dollar
of	IN	of
flash	NN	flash
storage	NN	storage
around	IN	around
this	DT	this
time	NN	time
next	JJ	next
year	NN	year
(	-LRB-	(
see	VB	see
Figure	NNP	Figure
1	CD	1
in	IN	in
http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p1026r0.pdf	CD	http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p1026r0.pdf
)	-RRB-	)
.	.	.
</s>
<s type="decl">
Persisting	VBG	persist
data	NNS	datum
to	TO	to
these	DT	these
DIMMs	NNPS	DIMMs
is	VBZ	be
as	RB	as
straightforward	JJ	straightforward
as	IN	as
telling	VBG	tell
your	PRP$	your
CPU	NN	CPU
to	TO	to
flush	VB	flush
modified	VBN	modify
cache	NN	cache
lines	NNS	line
to	TO	to
main	JJ	main
memory	NN	memory
.	.	.
</s>
<s type="decl">
On	IN	on
current	JJ	current
Intel	NNP	Intel
CPUs	NNP	CPUs
,	,	,
this	DT	this
is	VBZ	be
inefficient	JJ	inefficient
as	IN	as
one	PRP	one
must	MD	must
also	RB	also
evict	VB	evict
those	DT	those
lines	NNS	line
from	IN	from
the	DT	the
cache	NN	cache
,	,	,
but	CC	but
on	IN	on
all	DT	all
recent	JJ	recent
ARM	NNP	ARM
CPUs	NNPS	CPUs
and	CC	and
on	IN	on
Ice	NNP	Ice
Lake	NNP	Lake
Intel	NNP	Intel
CPUs	NNPS	CPUs
onwards	RB	onwards
,	,	,
one	PRP	one
can	MD	can
flush	VB	flush
modified	VBN	modify
cache	NN	cache
lines	NNS	line
without	IN	without
eviction	NN	eviction
.	.	.
</s>
<s type="imp">
So	RB	so
,	,	,
given	VBN	give
that	IN	that
we	PRP	we
're	VBP	be
about	IN	about
a	DT	a
year	NN	year
out	RP	out
from	IN	from
these	DT	these
things	NNS	thing
appearing	VBG	appear
in	IN	in
commodity	NN	commodity
(	-LRB-	(
if	IN	if
likely	RB	likely
premium	NN	premium
)	-RRB-	)
hardware	NN	hardware
,	,	,
how	WRB	how
would	MD	would
/r/cpp	NNP	/r/cpp
like	IN	like
to	TO	to
see	VB	see
C++	NNP	C++
support	VB	support
persistent	JJ	persistent
memory	NN	memory
?	.	?
</s>
<s type="frag">
Some	DT	some
options	NNS	option
:	:	:
1	CD	1
.	.	.
</s>
<s type="imp">
Do	VB	do
nothing	NN	nothing
,	,	,
see	VB	see
how	WRB	how
things	NNS	thing
are	VBP	be
in	IN	in
a	DT	a
few	JJ	few
years	NNS	year
from	IN	from
now	RB	now
.	.	.
</s>
<s type="frag">
2	CD	2
.	.	.
</s>
<s type="decl">
Intel	NNP	Intel
's	POS	's
persistent	JJ	persistent
memory	NN	memory
library	NN	library
(	-LRB-	(
http://pmem.io/pmdk/	NNP	http://pmem.io/pmdk/
)	-RRB-	)
will	MD	will
be	VB	be
sufficient	JJ	sufficient
.	.	.
3	CD	3
.	.	.
</s>
<s type="decl">
Intel	NNP	Intel
's	POS	's
persistent	JJ	persistent
memory	NN	memory
library	NN	library
is	VBZ	be
too	RB	too
alien	JJ	alien
,	,	,
we	PRP	we
need	VBP	need
something	NN	something
more	RBR	more
STLish	NNP	STLish
.	.	.
4	CD	4
.	.	.
</s>
<s type="decl">
We	PRP	we
need	VBP	need
this	DT	this
support	NN	support
immediately	RB	immediately
!	.	!
</s>
<s type="imp">
Refactor	VB	Refactor
the	DT	the
C++	NNP	C++
23	CD	@card@
standard	NN	standard
to	TO	to
directly	RB	directly
support	VB	support
persistent	JJ	persistent
memory	NN	memory
(	-LRB-	(
understanding	NN	understanding
that	IN	that
this	DT	this
will	MD	will
slip	VB	slip
the	DT	the
release	NN	release
date	NN	date
considerably	RB	considerably
later	RBR	late
than	IN	than
2023	CD	@card@
)	-RRB-	)
Disclaimer	NNP	Disclaimer
:	:	:
I	PRP	I
'm	VBP	be
the	DT	the
guy	NN	guy
presenting	VBG	present
P1026	CD	P1926
<hi rend="bold">
A	DT	a
call	NN	call
for	IN	for
a	DT	a
Data	NNP	Data
Persistence	NNP	Persistence
(	-LRB-	(
iostream	NN	iostream
v2	NN	v2
)	-RRB-	)
study	NN	study
group	NN	group
</hi>
to	TO	to
WG21	NNP	W621
LEWG	NNP	LEWG
this	DT	this
Wednesday	NNP	Wednesday
morning	NN	morning
coming	VBG	come
,	,	,
and	CC	and
I	PRP	I
am	VBP	be
absolutely	RB	absolutely
canvassing	VBG	canvass
for	IN	for
what	WP	what
kind	NN	kind
of	IN	of
feelings	NNS	feeling
the	DT	the
C++	NNP	C++
userbase	NN	userbase
have	VBP	have
regarding	VBG	regard
support	NN	support
for	IN	for
persistent	JJ	persistent
memory	NN	memory
.	.	.
</s>
<s type="decl">
WG21	FW	W621
will	MD	will
likely	RB	likely
prefer	VB	prefer
option	NN	option
1	CD	1
above	RB	above
,	,	,
but	CC	but
if	IN	if
the	DT	the
C++	NNP	C++
community	NN	community
were	VBD	be
feeling	VBG	feel
very	RB	very
strongly	RB	strongly
about	IN	about
option	NN	option
4	CD	4
...	:	...
:	:	:
)	-RRB-	)
Anyway	RB	anyway
,	,	,
this	DT	this
is	VBZ	be
your	PRP$	your
chance	NN	chance
to	TO	to
get	VB	get
feedback	NN	feedback
to	TO	to
the	DT	the
C++	NNP	C++
standards	NNS	standard
committee	NN	committee
,	,	,
and	CC	and
maybe	RB	maybe
help	VB	help
guide	VB	guide
a	DT	a
decision	NN	decision
.	.	.
</s>
<s type="frag">
Many	JJ	Many
thanks	NNS	thank
in	IN	in
advance	NN	advance
for	IN	for
your	PRP$	your
time	NN	time
and	CC	and
feedback	NN	feedback
.	.	.
</s>
<s type="frag">
http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p1026r0.pdf	CD	http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p1026r0.pdf
</s>
</p>
</sp>
<sp who="#OldWolf2">
<p>
<s type="decl">
Non-volatile	JJ	non-volatile
RAM	NNP	RAM
is	VBZ	be
nothing	NN	nothing
new	JJ	new
,	,	,
one	CD	one
of	IN	of
the	DT	the
first	JJ	first
C	NNP	C
embedded	JJ	embed
systems	NNS	system
I	PRP	I
worked	VBD	work
on	IN	on
had	VBN	have
only	JJ	only
NVRAM	NNP	NVRAM
,	,	,
which	WDT	which
was	VBD	be
used	VBN	use
for	IN	for
working	VBG	work
memory	NN	memory
as	RB	as
well	RB	well
as	IN	as
storage	NN	storage
.	.	.
</s>
<s type="decl">
Incidentally	RB	incidentally
the	DT	the
manufacturer	NN	manufacturer
collapsed	VBD	collapse
because	IN	because
they	PRP	they
could	MD	could
n't	RB	n't
compete	VB	compete
on	IN	on
price	NN	price
with	IN	with
other	JJ	other
devices	NNS	device
that	WDT	that
used	VBD	use
a	DT	a
mix	NN	mix
of	IN	of
cheap	JJ	cheap
RAM	NNP	RAM
and	CC	and
Flash	NNP	flash
.	.	.
</s>
</p>
<p>
<s type="decl">
I	PRP	I
do	VBP	do
n't	RB	n't
recall	VB	recall
the	DT	the
exact	JJ	exact
details	NNS	detail
now	RB	now
,	,	,
but	CC	but
I	PRP	I
think	VBP	think
the	DT	the
way	NN	way
the	DT	the
OS	NNP	OS
set	VBD	set
up	RP	up
was	VBD	be
that	IN	that
certain	JJ	certain
address	NN	address
ranges	NNS	range
would	MD	would
be	VB	be
marked	VBN	mark
as	IN	as
do	VB	do
n't	RB	n't
reset	VB	reset
on	IN	on
startup	NN	startup
,	,	,
and	CC	and
we	PRP	we
could	MD	could
assign	VB	assign
variables	NNS	variable
to	TO	to
that	WDT	that
address	VB	address
range	NN	range
via	IN	via
a	DT	a
source	NN	source
code	NN	code
extension	NN	extension
.	.	.
</s>
<s type="decl">
Then	RB	then
we	PRP	we
could	MD	could
either	CC	either
just	RB	just
work	VB	work
directly	RB	directly
in	IN	in
those	DT	those
variables	NNS	variable
,	,	,
or	CC	or
(	-LRB-	(
to	TO	to
support	VB	support
adding	VBG	add
struct	NN	struct
members	NNS	member
in	IN	in
future	NN	future
)	-RRB-	)
.	.	.
memcpy	NN	memcpy
in	IN	in
and	CC	and
out	IN	out
of	IN	of
it	PRP	it
with	IN	with
some	DT	some
primitive	JJ	primitive
serialization	NN	serialization
.	.	.
</s>
</p>
<p>
<s type="decl">
I	PRP	I
'm	VBP	be
sure	JJ	sure
people	NNS	people
can	MD	can
come	VB	come
up	RP	up
with	IN	with
much	RB	much
better	JJR	good
idioms	NNS	idiom
nowdays	RB	nowdays
though	RB	though
:	:	:
)	-RRB-	)
</s>
</p>
</sp>
</text>