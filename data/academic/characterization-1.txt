 1. IntroductionThe increasing demands for manufacturing accuracies and quality control due to the rapid development of nanotechnology, ultraprecision machining, micro-, and nanofabrications, etc. [1,2] and the requirements for precision in surface finishing in different technologies such as additive manufacturing [3], mechanical parts with structured surfaces [4], etc., require the use of increasingly sophisticated measurement systems and measurement traceability from a metrological point of view.Calibration provides a wide range of information about microscope performances. The ever-increasing demand for improved surface quality and tighter geometric tolerances has led to augmentations in the investigations of manufacturing technologies [5]. Measurements using optical microscopes are often affected by common path noise, disturbance in light source and ambient lighting, etc., which cause measurement defects and outliers [6,7], as well as attract investigations on noisy data processing [8]. The need for standardization is becoming ever greater as the range of capturing three-dimensional (3D) information of microscope techniques continues to increase [5,9]. For optical confocal microscopes, the Z-calibrations at nm levels are typically good, while the X- and Y-accuracies are often left, without further notice than resolution limits of the optics [10,11]. Among the investigations of lateral calibrations, many studies focus on the optical system [12]. For example, H. Ni et al. proposed a new method to achieve structured detection using a spatial light modulator, which modulates the Airy disk amplitude distribution according to the detection function in the collection arm [13] and B. Wang et al. presented confocal microscopy with structured detection in a coherent imaging process to achieve a higher resolution with a comparably large pinhole [14], however, the systematic geometric errors which adversely affect the relative position and orientation between measuring probes and measurands are usually neglected [15,16]. B. Daemi et al. designed a comprehensive verification test by using a high precision metrology method based on subpixel resolution image analysis [17]. The calibration of confocal microscopes usually relies on traceable standard artefacts, which are commonly made up of regular patterns [10].This paper describes the experimental studies based on the kinematic modeling and algorithms for the correction of the geometric errors developed in Part I [18]. Section 2 and Section 3 introduce the methodologies for experiments and uncertainty evaluation individually. Section 4 presents the experiment on a dot grid target for correction coefficients determination and their corresponding uncertainty evaluation. Section 5 implements an experiment and corrects the measured data with determined coefficients, comparing the residuals with respect to certified values before and after corrections. Section 6 presents the conclusions. Following Section 6, acknowledgements and references are included. 2. Methodology for the Experimental StudyThe purposes of this experimental study were to, first, determine the error correction coefficients, i.e., defined in the kinematic geometric error correction model developed in Part I [18] and, secondly, apply the determined parameters of coefficients and the correction mathematical model for new measurement data calibration. The dot grid target standard artefact was implemented as the measurand of the experiments. By comparing the residuals of measured points and corrected points with respect to the certified values, the practicality and significance of our developed models and algorithms for lateral stage error calibration were observed.Two experiments were carried out with our imaging confocal microscope, which is a Leica Confocal Dual Core 3D Measuring Microscope (Leica DCM-3D), at the “Laboratorio de Investigación de Materiales de Interés Tecnológico” (LIMIT) of the Technical University of Madrid. The first experiment measured the dot grid target standard for the determination of the correction coefficients. The second experiment measured another area of the dot grid standard, processing the measurement data with the same developed and validated algorithms implemented in the first experiment. The purpose of this experiment was to observe whether the corrected data improved as compared with the raw measurement data. Because the second experiment used the same measurement parameters, data processing algorithms, and procedures, and measured a different area of the same dot grid standard, this comparison is important as other factors, which might influence the results, could be excluded majorly, such as the uncertainties or inaccuracies generated by algorithms of cylinder separation, center fitting, and movement scope of the lateral stage, etc. 3. Methodology and Procedures for Uncertainty EstimationA statement of measurement is complete only if it provides an estimate of the quantity concerned, as well as a quantitative evaluation of the estimate’s reliability, i.e., the associated uncertainty [18]. Accompany measurement results by quantitative statements about their accuracy is very important particularly when the result are part of a measurement chain tracking back to national standards or when decisions about product specifications are taken [19].The document issued by BIPM, Guide to the Expression of Uncertainty in Measurement (GUM) [20] provides a method and procedure for the evaluation and expression of measurement uncertainties [21]. This method is termed the GUM uncertainty framework in supplement 1 and supplement 2 (GUM-S1 and GUM-S2) [22,23] and other bibliographies [19,24]. The GUM uncertainty framework has two main limitations [2,25]. The first limitation is the lack of generality of the procedure to obtain an interval to contain the values of the measurand with a stipulated coverage probability [25]. In the GUM uncertainty framework, the way a coverage interval is constructed to contain values of the measurand with a stipulated coverage probability is approximate [22]. The second limitation is that insufficient guidance is given for the multivariate case in which there is more than one measurand, namely, more than one output quantity [22,25]. In order to address these limitations, Working Group 1 of the Joint Committee for Guides in Metrology (JCGM) has produced two specific guidance documents, namely GUM-S1 and GUM-S2 [23,24], on the Monte Carlo method (MCM) for uncertainty evaluation and extensions to any number of measurands (output quantity), respectively [22].The MCM provides a general approach to obtain a numerical representation

G

 of the distribution function


G

Y


(

η

)

 for

Y

. The heart of the approach is making repeated draws from the probability density functions (PDFs) for the input variables


X
i


 (or joint PDF for

X

) and the evaluation of the output quantity. Assignment of the PDFs for the input variables is dependent on each experiment. The same case applies to the evaluation of the output quantity. The distribution function


G

Y


(

η

)

 encodes all information known about the output quantity

Y

. Properties of

Y

 can be approximated using


G

Y


(

η

)

. The quality of

G

 depends on the number of draws made. The symbol

y

 represent the output measurement results. It is determined by the input measurement results



x

i


:




y

=
f
(


x

1

,
…
,


x

N

)




(1)

The relationship between the PDF of output measurement results and input measurement results is:





g


Y


(

η

)
=


∫



g




X

1

,
…
,


X

N



(


ξ

1

,
…
,


ξ

N

)



×
δ

[


η

−
f
(


ξ

1

,
…
,


ξ

N

)

]

d


ξ

1

…
d


ξ

N





(2)


where

η

 denotes possible values that can be distributed to

Y

,

δ

[
⋯
]


 denotes the Dirac delta function.Figure 1 provides an illustration of the propagation of distributions for input and output quantities. The expectation of the output quantities can be obtained by its PDF



g


Y


(

η

)

 as:



E
(

Y
i

)
=



∫

−
∞

∞



η
i





g


Y
i



(

η
i

)
d

η
i





(3)

The variance of the output quantities can be obtained by its PDF



g


Y


(

η

)

 as:



V
(

Y
i

)
=





∫

−
∞

∞



[


η
i

−
E
(

Y
i

)

]





2


g


Y
i



(

η
i

)
d

η
i





(4)

The covariance of the output quantities can be obtained by its PDF



g


Y


(

η

)

 as:



C
o
v
(

Y
i

,

Y
j

)
=
C
o
v
(

Y
j

,

Y
i

)
=



∫

−
∞

∞





∫

−
∞

∞



[


η
i

−
E
(

Y
i

)

]





[


η
j

−
E
(

Y
j

)

]


g


Y
i

,

Y
j



(

η
i

,

η
j

)
d

η
i




d

η
j





(5)


where


g


Y
i

,

Y
j



(

η
i

,

η
j

)

 is the joint PDF for the two random variables


Y
i

,

Y
j


.The correlation of the output quantities can be obtained by its PDF



g


Y


(

η

)

 as:



C
o
r
r
(

Y
i

,

Y
j

)
=
C
o
r
r
(

Y
j

,

Y
i

)
=


C
o
v
(

Y
i

,

Y
j

)




V
(

Y
i

)
V
(

Y
j

)








(6)

 4. Experiment for Determination and Uncertainty Evaluation of the Error Correction CoefficientsThe first experiment is the measurement of the standard artefact of the dot grid target. The purpose of this experiment is to obtain the parameters of the coefficients of the kinematic rigid body errors. Uncertainties of the obtained correction coefficients are also evaluated. 4.1. Determination of Error CoefficientsThe standard artefact of the dot grid target is introduced in Part I of [18]. This artefact was measured in an environment under a controlled temperature of 20 ± 1 °C, using the Leica DCM-3D Confocal Microscopy at the Metrology Laboratory of the Technical University of Madrid. A magnification objective of 50x was used, with a numerical aperture of 0.9. The acquisition parameter of measurement area was defined as the topography stitching measurement, with a 4 × 4 extended topographies, covering an area of 0.828 × 0.621 mm2. The parameter of overlapping area was 25% and the correlation takes XYZ option. The level of resolution was 1, and the measured extended topographies contained 2496 × 1872 pixels.After the measurement, the confocal system generated a file with suffix name ”.dat”, containing three vectors, which are values of the X, Y, and Z coordinates. Data of this file was imported and analyzed by our developed algorithms. The raw measurement data is shown in Figure 2, which is an inclined surface with some outliers. This surface was aligned to be parallel with the X and Y coordinate plane using our developed surface rotation methods introduced in Part I [18]. The aligned surface is shown in Figure 3. The distribution of the values of the X, Y, and Z coordinates of the surface after rotation is shown in Figure 4.After rotation, the data were separated into surface plane and cylinders. The surface reconstruction of the data of cylinders is shown in Figure 5. It is obvious that this data has many outliers. Those outliers are detected and deleted by the method introduced in our previous work [8]. The distribution of the measurement values of the X and Y coordinates, as well as the threshold for outlier detections are shown in Figure 6 and Figure 7 individually. The surface reconstruction by the data of cylinders with outliers removed is shown in Figure 8.The separated cylinders are shown in Figure 9. They are denoted by different colors and numbers.Those individual point clouds of cylinders are processed by our introduced algorithms. Their centers are fitted and shown in Figure 10, in comparison to their corresponding certified positions.The measured cylinder centers, shown in Figure 10, are all distorted in one direction. This might be caused by the location of the measurand, as it is impossible to locate the measurand parallel with the x-axis. Therefore, those measured centers are first aligned to be parallel with the x-axis. Then, they are calibrated to the certified points using our developed mathematical models and algorithms. From this, the results of the coefficients defined in the mathematical model, i.e., Equations (4) and (5) in Part I [18], can be obtained. The results are indicated in Table 1. Moreover, rotation of the calibrated values of the cylinder centers to align them with the measured ones are also carried out for the validation of the rotation capability.With those obtained parameters of the coefficients, the corrected points are calculated according to Equations (4) and (5) in Part I [18]. Figure 11 shows the corresponding positions of certified, measured, and corrected points. The results of the mean errors, maximum errors, sum of squared errors, and standard deviations of the errors are indicated in Table 2.The Euclidean residuals of each point are plotted by contours, as shown in Figure 12 and Figure 13, which is the contour of the Euclidean residuals of the measured and corrected points with respect to the certified values.It can be concluded that the determined coefficients for kinematic geometric error correction works very well in this measurement. 4.2. Uncertainty EvaluationUncertainty evaluation of the geometric error coefficients is based on the algorithms introduced in Section 3. The heart of the approach is making repeated draws from the PDFs for the input variables


X
i


 (or joint PDF for

X

) and the evaluation of the output quantity. Here, we define the determinations of the number of repeated draws, namely, the number of simulation trials, the PDFs for the input variables, and the evaluation of the output quantity.According to GUM-S2 [23] the main stages of uncertainty evaluation constitute formulation, propagation, and summarizing describes as follows:
The first stage of formulation includes:
(a)Define the output quantity, namely, the geometric error correction coefficients


C
c

=
(

a
1

,
…

g
3

)

;(b)Determine the input quantity upon which


C
c


 depends, namely, the measurement results

(

x

,

y

)

 and their corresponded certified values

(


P


x


,


P


y


)

;(c)Develop a measurement function
f
 or measurement model relating the input and output quantities, namely, Equations (4) and (5);(d)On the basis of available knowledge, assign PDFs to the components of the input quantities. As indicated by Table 2 in Part I [18], the certified values

(


P


x


,


P


y


)

 follow a rectangular distribution

U
(
−
1
,
1
)

 μm. As there is no more information about the sources of uncertainties for

(


P


x


,


P


y


)

 or information for the measured values of X and Y coordinates (x, y), here does not assign more uncertainties to the input quantities, for not introducing unnecessary uncertainties.The second stage, propagation, includes:Propagate the PDFs for the components of input quantities through the model to obtain the (joint) PDF for the output quantity.The final step, summarizing, includes:Use the PDF for the output quantity to obtain the expectation of the output quantity, the uncertainty matrix, also named covariance matrix, associated with the expectation of the output quantity, and a coverage region containing the output quantity with a specified probability
p
(the coverage probability).The simulation was repeated 1 × 104 times. Mean values, expanded uncertainties (

k
=
2

), as well as lower and upper boundaries for a 95% coverage interval are listed in Table 3. Distributions for the output quantities are shown in Figure 14 and we observe that non-symmetric distributions and not assimilable to normal distributions are obtained. 5. Experimental Study of the Applications of Determined CoefficientsThis section aims to verify the applicability of the determined error correction coefficients and the residuals of measured and corrected points with respect to certified points are compared.This experiment measures the dot grid target standard used in Section 4. The measured area of this standard is different from those in Section 4. All the environmental and operational parameters are the same as those in Section 4. The measurement data are processed using the same algorithms and procedures, until the fitted cylinder centers are approximated parallel with the x-axis. Then the fitted centers are corrected by the error correction coefficients determined. By comparing the mean residuals, the sum of all squared residuals, and the standard deviation of residuals of measured points and corrected points with respect to certified positions, the effectiveness of the calculated coefficients and our model can be observed.Measurement data are processed using our developed and validated algorithms. The raw measurement data with form removed are shown in Figure 15, implementing the form removal method presented in the pair publication Part I [18] Section 4.1. The cylinders are separated from the base with our developed algorithms, with results demonstrated in Figure 16. Figure 16a shows the initial separated cylinders, Figure 16b shows the cylinders with outliers removed and with clusters classified, and Figure 17 shows the histograms of the three coordinates of the cylinders.The separated clusters are fitted for their centers. The coordinate values of the fitted cylinder centers are shown in Table 4. Figure 18 shows the fitted cylinder centers, as well as the centroids of each cluster data.As shown in Figure 18, the cluster numbered 29 has too many outliers. Here, we only choose the first 28 clusters for the kinematic geometric error correction. The correction employs the mathematical model Equations (4) and (5), as well as our calculated error coefficients. Before correction, the data are aligned to be parallel with the X coordinate as much as possible. Table 5 shows the aligned measurement data and the corrected data.The aligned and corrected measurement data are both adjusted to a beginning of

(
0
,
0
)

. The results of the measured and corrected positions are compared with the certified positions in Table 6. Figure 19 illustrates the measured, corrected, and the certified positions. The mean error, the maximum error, the sum of the squared errors, and the standard deviations of the errors are indicated in Table 7. The mean error and residual between the measured positions and the certified positions is 8.1 μm, while the mean error and residual between corrected positions and the certified positions is 5.7 μm, improved 29.6%. The maximum error between the measured positions and the certified positions is 15.6 μm, while the maximum error between corrected positions and the certified positions is 11.5 μm, reduced 26.3%. The sum of squared errors reduced from 2173.3 μm2 to 1136.2 μm2, which is 47.7%. It can be observed that all four types of errors are much smaller after correction with the error coefficients.Figure 20 and Figure 21 show the contour of the mean errors of the measured data and the corrected data individually. Figure 22 shows the comparison of the error vectors from the certified positions to the measured positions and the vectors from the certified positions to the corrected positions.According to the above results, we found that the errors and residuals between the corrected positions and the certified positions are much smaller than the errors and residuals between the measured positions and certified positions. This indicates that our method for the X and Y coordinate calibration and correction is effective and useful. 6. Conclusions and Future WorkThis paper implemented two experiments for the illustration and the verification of our proposed method for the correction of the kinematic geometric errors produced by the movement of the lateral stage of confocal microscopes. The experimental results indicate that the mean residual reduced 29.6%, the maximum error reduced 26.3%, and the sum of squared errors reduced 47.7%.The first experiment measured the dot grid targets with extended topography. After processing the measurement data, the error correction coefficients defined in the mathematical model, i.e., Equations (4) and (5) presented in Part I [18] were determined. The uncertainties of the values of those coefficients were also evaluated using the Monte Carlo method. The simulation number was 1 × 104. Distributions of the uncertainties of each coefficient, as well as their lower and upper boundaries of a 95% interval, were indicated.The second experiment measured a different area of the same standard artefact. By correcting the measurement data using our mathematical model and the determined coefficients, the corrected results were obtained. The residuals between the raw measured points and their corresponding certified values were compared to those between the corrected points and the certified values.The data processing algorithms and procedures, such as separations of the flats and cylinders, data partitions, outlier eliminations, K-means clustering, cylinder centers fittings, etc. were the same for the two experimental studies. The difference between the data processing for the two experiments was in the final procedures. The first experiment fitted the values of the coefficients used the nonlinear least squared method. The second method applied the mathematical models and the determined values of the coefficients to the measured data for obtaining the corrected coordinate values of the points.Results of the experiments demonstrated that our proposed method for lateral stage kinematic geometric error correction is efficient and useful.Among the next practical steps for improving the proposed method is a focus on the stitching algorithm of the optical element [26], which highly needs a calibration and correction of the stitching result.
