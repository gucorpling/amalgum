 1. IntroductionAs the backbone of an urban transit system, urban rail transit plays an important role in urban development. A reasonable urban rail transit network can not only ensure the efficiency of urban passenger transport but also promote the sustainable development of a city. The network design, which will determine the structure and the overall layout of the network, is the most important stage in urban rail transit planning. How to meet the urban development characteristics in this stage is an important question.Urban rail transit network design can be affected by many factors, such as urban space, structure and layout, passenger demand, society and economy, environmental impact, and policy, etc., and it is complicated to quantify the factors simultaneously, so subjective and qualitative methods are usually used in most practices of network design. With the development of computer technology and the application of mathematical methods, nowadays planners and researchers are gradually employing quantitative models in transit network design. Among them, a symmetrical urban spatial structure model was proposed by Fielbaum et al. [1]. Based on the city model, four transit network structures (direct lines, feeder-trunk, hub and spoke, and exclusive lines) were calculated by Fielbaum et al. [2] to identify the applicability to the urban structure. But the network designed by this method is too idealized and theorized to determine specific passenger corridors, line alignments, and station locations for a real city. In view of the environmental impact, a multi-objective model, which takes the minimum off-gas emissions and the minimum travel time as objectives, was formulated by Zhang [3]. With the model, the network with environment-friendly characteristics can be obtained. In view of the risk management policy, some risk-averse strategies (minimization of the maximum regret, value-at-risk measures) were introduced to the rail transit network design problem by Cadarso [4]. For each strategy, an optimization model with the objective of minimum risk impact was established. But the models considered the effects of each strategy separately rather than synthetically. For the quantitative methods of rail transit network design, mathematical programming is most commonly used. During the optimization process, the planning objectives determined by construction and service requirements include maximizing the benefits of operators [5,6,7,8], users [9] or both [10,11,12,13]. For research projects, the rail transit design can be classified as the design of a new rail transit network and the expansion of an existing rail transit network [14].Among the influencing factors, the urban characteristics of road network, trips and land use are the most relevant, basic and important factors with the urban rail transit network, which should be given priority consideration. On one hand, as a kind of mass and punctual transit, urban rail transit can greatly improve the travel convenience for passengers and change the mode sharing of urban trips [14,15]. On the other hand, land use value along the lines and around the stations can be greatly improved with the impact of urban rail transit, which can effectively guide the rapid development of the city [16,17]. Therefore, in this paper, a quantitative model, which takes into account the urban characteristics simultaneously and is applicable to real cities is developed while the cities were generally regarded as connected graphs in most previous research. In the model, a generation method of a basic network, which takes into account the matching between the generated network and the urban road network, is proposed. Two matching indexes are introduced to the constraints: one indicates the matching degree between the network and the urban trips, the other indicates the matching degree between the network and the land use. The model takes the maximum transport efficiency of the network and the maximum travel convenience for passengers as objectives, which stands in the perspective of both managers and users. Due to the high complexity, solving this type of model has been proved to be an NP-hard problem [6,9,18], which means that as the network size increases, the variables increases exponentially. So a neighborhood search algorithm for a real-size network is developed based on a simulated annealing method in the paper.The structure of this paper is organized as follows. Section 2 presents the determination of the matching indexes between the urban rail transit network and the urban characteristics. Section 3 presents the multi-objective network design model, followed by the solving algorithm in Section 4. Section 5 presents the real-world case calculation and analysis. Section 6 presents the conclusions. 2. Determination of Matching IndexesIn the quantitative model, the urban road network, trips and land use are the key factors to be considered. The basic network, which connects the locations of large traffic volume and covers the passenger flow corridors, will be determined to ensure the matching between the rail transit network and the urban road network. Two indexes will be proposed to evaluate quantitatively the matching degrees between the rail transit network and the urban trips, and similarly between the rail transit network and the land use.The determined basic network, the calculated matching indexes, the given candidate stations, the passenger demand, etc. are all used as inputs of the model. While generating the network, the matching degrees will be constrained in a suitable range, and the line alignments will be bounded in the basic network. It should be noted that only some of the candidate stations will be selected as the actual stations according to the principle of optimization. After iterations, a network that meets the constraints and has the optimal objective will be obtained. 2.1. Structural Importance of Stations 2.1.1. Evaluation IndexesThe structural importance of a station refers to the importance of its position in the topological network. In this paper, the urban rail transit network is regarded as a complex network, and the degree centrality, the closeness centrality and the betweenness centrality [19,20] of the nodes in the complex network are used to describe the structural importance of the stations from different dimensions, respectively.The degree centrality

D

C
i


 of station
i
 reflects the direct relevance between the station
i
 and other stations. The larger the value, the closer the relationship between the station and other stations in the network. Assuming that

D

C
t


,

D

C
m


 and

D

C
e


 are the index values of transfer station, intermediate station and terminal station respectively, they satisfy

D

C
t

>
D

C
m

>
D

C
e


. In the undirected graph network,

D

C
i


 is calculated by Equation (1):



D

C
i

=



k
i



n
−
1






(1)


where


k
i


 is the degree value of station
i
, which is defined as the number of edges connected to the station
i
.
n
 is the number of stations in the network.The closeness centrality

C

C
i


 of a station
i
 reflects the convenience of arriving at the station
i
 from other stations. The larger the closeness centrality value, the greater the extent to which the station
i
 resides in the center of the network, and the shorter the average distance from other stations to the station
i
.

C

C
i


 is calculated by Equation (2):



C

C
i

=


n
−
1




∑

j
=
1

n



d

i
j










(2)


where


d

i
j



 is the length of shortest path between station
i
 and station
j
.In the urban rail transit network, the station
i
 with high betweenness centrality

B

C
i


 plays a key role in the transit of passenger flow, which reflects the bridging function in the connection between other stations. The larger the index, the more the number of travel paths passing through the station.

B

C
i


 is calculated by Equation (3):



B

C
i

=

2

(
n
−
1
)
(
n
−
2
)




∑

s
≠
t






n

s
t

i




g

s
t










(3)


where


g

s
t



 is the number of shortest paths that have the same and the shortest length between stations
s
 and
t
,


n

s
t

i


 is the number of paths included in


g

s
t



 and passing through the station
i
.In order to coordinate the multi-dimensional importance of station
i
 in the network topology, a comprehensive importance evaluation index


I
i


 is proposed, as shown in Equation (4):




I
i

=

w
1

D

C
i

+

w
2

C

C
i

+

w
3

B

C
i





(4)


where


I
i


 is the comprehensive importance degree of station
i
 in the network structure,


w
1


,


w
2


, and


w
3


 are the weights of the structural indexes from different dimensions.With the index


I
i


, the importance of station
i
 in the topological network can be evaluated comprehensively, reflecting the status of the station in the network structure. In the following section,


I
i


 will be used to calculate the structural characteristics of an urban rail transit network. For the convenience of expression, the importance of the stations mentioned below refers to the comprehensive structural importance in the network. 2.1.2. Gravity Center of DistributionThe position status of a station reflected by its structural importance in the network is the result of the connection form of the network structure at its position. Therefore, the structural form of the network can be characterized by the distribution of the stations with different importance.If the importance degree of a station is regarded as its ‘gravity’, the more important the station is, the more ‘gravity’ it has in the network. In this paper, following the calculation principle of the gravity center in physics, the concept of gravity center of stations’ importance in a network is proposed. An urban rail transit network is usually regarded as a planar network. If the stations with different importance are assigned to certain values and locations, the distribution of stations can be expressed in the form of scatter in the network. The equilibrium gravity point of the scatter in the planar topological network is the gravity center of the stations’ importance distribution, as shown in Figure 1. In Figure 1,


G
A


,


G
B


 and


G
C


 are the ‘gravity’ of station A, B and C, respectively, and the point


O
S


 is the gravity center. The calculation method of the coordinates of


O
S


 is shown in Equations (5)–(6):






x
¯


1

=




∑

i
=
1

n



x
i


I
i







∑

i
=
1

n



I
i









(5)








y
¯


1

=




∑

i
=
1

n



y
i


I
i







∑

i
=
1

n



I
i









(6)


where

(



x
¯


1

,



y
¯


1

)

 is the coordinate pair of the gravity center of stations’ importance,
n
 is the number of stations in urban rail transit network,

(

x
i

,

y
i

)

 is the coordinate pair of station
i
.The gravity center reflects the emphasis of rail transit development on urban spatial location. The location of the gravity center will change with the development of rail transit, and the focus area of the center reflects the importance of the urban area to a certain extent. The index will be used to calculate the matching degree between the network and the urban trips. 2.1.3. Fractal DimensionFractal theory originated in the late 1960s and was founded by Mandelbrot, B [21]. The theory was originally used to describe highly irregular graphics. Fractal dimension is the most important parameter of fractal theory. It is used to describe the dimension of complex irregular graphics, which is the measure of spatial scale and overall complexity of the graphics. In 1991, L. Benguigui and M. Daoud [22] inspected the railway system in the suburb of Paris and found that the railway network showed a branched fractal structure. After that, the fractal theory was gradually applied in the field of transportation.In fact, there are fractal features in a certain space–time range between the city and the transportation network systems, and their fractal geometry properties reflect the self-similar characteristics of the systems. In this paper, the city is regarded as a circular area, and the radius is centered around the urban center. Figure 2 shows the urban rail transit lines in the city with radius
r
, where the point O represents the urban center. The sum of the structural importance degrees of all stations

I
(
r
)

 within the radius
r
 is calculated by Equation (7):



I
(
r
)
=


∑

i
=
1



n
r





I
i



(
r
)




(7)


where


I
i

(
r
)

 is the structural importance degree of station
i
 within the radius
r
,


n
r


 is the number of stations within the radius
r
.According to the fractal theory,

I
(
r
)

 and
r
 satisfy the following relationship:



I
(
r
)
∝

r


D
S







(8)


where


D
S


 is the fractal dimension of the stations’ importance distribution.The city is divided into several circles by the radii with different lengths, and the stations with different importance are scattered in the circles. So the fractal dimensions corresponding to different radii can be obtained.The fractal dimensions corresponding to different radii can reflect the change of rail transit supply capacity from an urban center to a peripheral area. In fact, the urban development is biased towards the central area, so the supply capacity of the central area is usually larger than that of the peripheral area. The index will be used to calculate the matching degree between the network and the urban land use. 2.2. Matching with Urban Characteristics 2.2.1. Urban Road NetworkUsually, urban rail transit lines are laid along the roads, and only in special cases can be constructed through land blocks. Therefore, it is necessary to limit the roads, so as to determine the range and direction of the searchable sections when generating the network. In this way, not only the planner’s subjective and groundless decision can be avoided with mathematical model, but also reasonable route boundaries can be grasped. We refer to the topological network used to limit the search range and the search direction as the ‘basic network’. The locations of large traffic volume and passenger flow corridors are the main factors affecting the line alignments and network structure. Among the factors, the locations with large traffic volume are the main source of production and attraction of passenger flow, including transportation hubs and centers of a district. The transportation hubs include a bus transfer hub, bus terminal, railway station and airport, etc. The centers of a district include commercial and cultural sites, large enterprises, large residential areas and tourist attractions, etc. So the basic network should be established by connecting the main locations of large traffic volume and covering the main passenger flow corridors. Before establishing the basic network, the main passenger corridors are determined by a ‘cobweb assignment’ method, and the steps are as follows:Step 1: Generate OD (origin-destination) desire lines between traffic zones according to the predicted passenger demand.Step 2: Eliminate the inter-zone desire lines while the desire lines between adjacent zones are retained. The network formed by the retained desire lines is called ‘virtual cobweb’.Step 3: Passenger assignment is carried out on the ‘virtual cobweb’ with all-or-nothing method.Step 4: Judging the main passenger flow corridors according to the scale of passenger flow accumulation.Usually, most of the research on actual transit network designs are based on the premise that the basic network is known because of lacking effective determination method. Therefore, the determining process of the basic network proposed in this paper is as follows:Step 1: Selection of trunk roads that meet the conditions for rail transit construction. According to the urban traffic road network in the area requiring rail transit construction, the trunk roads along the passenger corridors and connecting the locations with large traffic volume are selected.Step 2: Selection of other roads that can connect the locations of large traffic volume.If the selected trunk roads cannot connect all the necessary locations of large traffic volume, other roads around the locations that meet the construction conditions and land-use requirements should be selected.Step 3: The main locations of large traffic volume are connected along the selected roads, and the topology network formed is the basic network.The locations with close distance and large traffic volume are merged. In this way, not only the complexity of solving the model, but also the detour distance of the generated transit lines can be reduced. Figure 3 shows the urban rail transit lines laid along the main routes in the basic network. 2.2.2. Trip IntensityThere is a certain difference for trip volumes in different traffic zones, and the volume in each zone includes the production and attraction of the trips. So, the trip intensity in each zone can be calculated by the amount of the production and attraction of the zone, as shown in Equation (9):




S
i

=

P
i

+

A
i





(9)


where


S
i


 is the trip intensity in traffic zone
i
,


P
i


 and


A
i


 are the production and attraction of trip volume in traffic zone
i
, respectively.Usually, the trip intensity of each zone can be considered to be concentrated in the centroid position of the zone. So, if the centroid positions are assigned to corresponding trip-intensity values, the distribution of the trip volume can be expressed in the form of scatter in the city. Similarly, if the trip intensity of each zone is regarded as the ‘gravity’ of the zone, the equilibrium point of the ‘gravity’ is the gravity center of trip intensity, as shown in Figure 4. In Figure 4, each area represents the traffic zone,


o
1




~
o


9


 are the centroid positions of traffic zones,


G
1

~

G
9


 are the ‘gravity’ values, and


O
P


 is the gravity center of trip intensity. The coordinates of the gravity center can be calculated by Equations (10)–(11):






x
¯


2

=




∑

i
=
1

m



x
i


S
i







∑

i
=
1

m



S
i









(10)








y
¯


2

=




∑

i
=
1

m



y
i


S
i







∑

i
=
1

m



S
i









(11)


where

(



x
¯


2

,



y
¯


2

)

 is the coordinate pair of the gravity center of urban trip intensity,
m
 is the number of traffic zones divided in the city,

(

x
i

,

y
i

)

 is the coordinate pair of centroid position of traffic zone
i
.The gravity center of urban trip intensity reflects the bias in the distribution of urban trip volume. If the trip intensity in an area increases, the gravity center will develop toward the area. On the contrary, if the trip intensity decreases, the development direction of the gravity center will be reversed.Urban rail transit is a main transportation mode for the residents in the city. The rail transit network should not only satisfy the capacity demand of passenger transport, but also match the distribution of trip volume in the city. So the importance distribution of rail transit stations should match the different trip volume in traffic zones. In this paper, the deviation value between the gravity center


O
P


 of urban trip intensity and the gravity center


O
S


 of stations’ importance distribution is used to characterize the matching degree between the network and urban trips, as shown in Figure 5. The deviation value is expressed as the ratio of Euclidean distance between


O
P


 and


O
S


 to urban radius, as shown in Equation (12).




d
(

O
P

,

O
S

)
=






(



x
¯


1

−



x
¯


2

)

2

+


(



y
¯


1

−



y
¯


2

)

2





r
′






(12)


where
d
 is the deviation value of gravity centers between the stations’ importance distribution and the trip intensity,

r
′

 is the radius calculated from the total area

A
(
r
′
)

 of the city, satisfying

A
(
r
′
)
=
π
r

′
2


.Furthermore, the matching degree


m
C


 between urban rail transit network and urban trips can be calculated by Equation (13). The value of


m
C


 is between 0 and 1, and the closer the index value is to 1, the higher the matching degree between the network and urban trips.





m
C

=

1

1
+
d
(

O
P

,

O
S

)






(13)

 2.2.3. Land-Use IntensityThere is a feedback relationship between urban rail transit and land use. Land-use intensity is the root cause of passenger volume for urban rail transit while the rail transit could have a positive guiding role in the development of surrounding land use. Therefore, in the stage of network design, it is necessary to ensure the matching between the urban rail transit network and the land-use intensity [23].Land-use intensity directly affects the accumulation of urban population, so it can be calculated by the population size within the area. Similarly, according to fractal theory, the relationship between the radius
r
 of the urban area and the land-use intensity satisfies Equation (14):



P
(
r
)
∝

r


D
P







(14)


where

P
(
·
)

 is the land-use intensity calculated by the sum of resident and employed population,


D
P


 is the fractal dimension of the land-use intensity.Deriving
r
 on both sides of Equation (14), we can obtain Equation (15):





d
P
(
r
)


d
r


∝

D
p


r


D
P

−
1






(15)

The area of the circle with radius
r
 is

A
(
r
)
=
π

r
2


, satisfying



d
A
(
r
)

/

d
r


=
2
π
r

, so the land-use intensity per unit area

ρ
(
r
)

 can be obtained from Equation (16):



ρ
(
r
)
=


d
P
(
r
)


d
A
(
r
)


∝

D
p


r


D
P

−
2






(16)

As can be seen from Equation (16), when


D
p

<
2

,

ρ
(
r
)
∝

D
p



(

1
/
r

)



|


D
P

−
2

|




, and as the statistical area expands with the increased radius
r
,

ρ
(
r
)

 gradually decreases from the city center to the periphery of the city. When


D
p

=
2

,

ρ
(
r
)

 remains unchanged. When


D
p

>
2

,

ρ
(
r
)

 gradually increases from the city center to the periphery of the city. Therefore, the fractal dimension

P
(
r
)

 reflects the changing trend of urban land-use intensity from the city center to the periphery of the city. However, the city does not develop evenly in all directions. Therefore, in this paper, the city is divided into several fan-shaped areas in the radial direction. The fractal dimension of land-use intensity in each fan-shaped area should be calculated. If the city is divided into

m
′

 areas (as seen in Figure 6, the city is divided into four fan-shaped areas using four quadrants.), the fractal dimension of land-use intensity in different areas can be expressed by the vector

[

D
1

,

D
2

,

D
3

,
…
,

D

m
′


]

, where the subscript number of the vector element represents the area number. So, the fractal dimension vector



D


S



 of stations’ importance distribution and the fractal dimension vector



D


P



 of land-use intensity can be expressed as

[

D

S
1


,

D

S
2


,

D

S
3


,
…
,

D

S
m
′


]

 and

[

D

P
1


,

D

P
2


,

D

P
3


,
…
,

D

P
m
′


]

, respectively, where


D

S
i



 is the fractal dimension of stations’ importance distribution in area
i
,


D

P
i



 is the fractal dimension of land-use intensity in area
i
,

i
=
1
,
2
,
…
m
′

. The deviation value between



D


S



 and



D


P



 is used to describe the matching between the network and urban land use, as shown in Equation (17):



d
(

D
S

,

D
P

)
=






∑

i
=
1


m
′





(

D

S
i


−

D

P
i


)

2







m
′






(17)


where

d
(

D
S

,

D
P

)

 is the deviation value of fractal dimensions between the stations’ importance distribution and the land-use intensity.Therefore, the matching degree


m
F


 between the network and land use can be expressed by Equation (18). The value of


m
F


 is between 0 and 1, and the closer the index value is to 1, the higher the matching degree between the network and the land use.





m
F

=

1

1
+
d
(

D
S

,

D
P

)






(18)

 3. Model Formulation 3.1. NotationsThe station and section of urban rail transit are abstracted as node
i
 in
N
 and edge

{
i
,
j
}

 in
E
, respectively. The topological network for urban rail transit is established, which is expressed as

G
=
G
(
N
,
E
)

. The notations in the model are shown in Table 1, Table 2 and Table 3. 3.2. Objective FunctionsIn this paper, we focus on how to consider the characteristics of urban road network, trips and land use in the quantitative network design. So other factors involved in the model have to be simplified. The model is formulated based on the assumption that passenger demand for the urban rail transit is already known.In this paper, the logit-based multi-path passenger flow assignment method is adopted. The utility function for path selection is expressed by passenger’s travel time which is the main influencing factor, as shown in Equation (19):




T
w
p

=

T
r
p

+

T
d
p

+

T
t
p

,
w
∈
W
,
p
∈

N
p





(19)


where


T
w
p


 is the travel time for OD pair
w
 along the path
p
,


T
r
p


 is the travel time in sections,


T
d
p


 is the dwell time at intermediate stations,


T
t
p


 is the transfer time.During the trip, too many transfers will seriously affect the convenience for passengers, and thus reduce the attraction of the urban rail transit. In order to describe the influence of transfers, the transfer penalty is used for transfer time calculation, as shown in Equation (20):




T
t
p

=


∑
k



T

t
k

p



(
λ
k
+
1
)

γ







(20)


where


T

t
k

p


 is the transfer time in the


k

t
h



 transfer station along the path
p
,
λ
 is the passenger’s transfer sensitivity,
γ
 is the adjustment coefficient which is usually larger than 1. The larger the
γ
, the greater the difference for sensitivity levels between different transfer times in the path.The effective paths, which are defined by Equation (21), are searched for between each OD pair in the network. So the path selection probability


P

w
p



 is calculated by Equation (22):




T
w
p

≤
(
1
+
H
)

T
w


p

min








(21)


where
H
 is the detour coefficient and is set to 1.5 in this paper,


T
w


p

min





 is the travel time in the shortest path.





P

w
p


=


exp
(
−
θ

T
w
p

)




∑

p
∈

N
p




exp
(
−
θ

T
w
p

)




,
w
∈
W
,
p
∈

N
p





(22)


where
θ
 is the calibration parameter.As a kind of public transport, urban rail transit should not only achieve the purpose of profitability for the managers, but also take into account the service function to meet passengers’ demand. In this paper, the objective functions are formulated from the perspective of both managers and passengers to improve the transport efficiency of the network and the convenience for passengers.Objective 1: Maximize the transport efficiency of the networkFrom the managers’ point of view, the network should transport as much passengers as possible to improve the operating income. Passenger turnover quantity refers to the product of the passenger volume and the distance transported in a certain period of time, and the unit is

p
·
k
m

. The larger the passenger turnover quantity, the higher the transport capacity of the network. Therefore, the passenger turnover quantity per unit length of the network is used to characterize the transport efficiency, which is expressed by Equation (23):



max

Z
1

=




∑

{
i
,
j
}
∈
E




q

i
j



d

i
j



e

i
j








∑

{
i
,
j
}
∈
E




d

i
j



e

i
j










(23)

Objective 2: Maximize the travel convenience for passengers In order to explore the relationship between the transfer times and the travel time in paths, the effective paths between each OD pair in the metro network of Beijing (as shown in Figure 7) are calculated, and the results are shown in Figure 8. As can be seen, a path with more transfer times tends to have more average travel time, and the greater the transfer sensitivity, the more obvious the phenomenon. Therefore, the average travel time of all passengers can be reduced while the average transfer times in paths are reduced.In order to improve the travel convenience for passengers, it is necessary to improve the directness of traveling for passengers. Reducing the transfer times for passengers is a very effective method to achieve this. Therefore, the average number of transfer passengers between lines is used as the second objective, which is expressed by Equation (24):



min

Z
2

=




∑

w
∈
W





∑

l
,
l
′
∈
L
,
l
≠
l
′





∑

p
∈

N
p





g
w


P

w
p



f

w
p
l

l
′














|
L
|

(

|
L
|

−
1
)

/
2







(24)

Both the two objectives have the same unit, so the problem can be easily converted into a single objective problem with weighted sum approach for the convenience of solving. The transformed objective function is shown in Equation (25):




max
Z
=


β
1


Z
1

−

β
2


Z
2





(25)


where


β
1

+

β
2

=
1

, satisfying

0
≤

β
1

≤
1

,

0
≤

β
2

≤
1

. 3.3. ConstraintsConstraint 1: Network topological relationship.





e

i
j

l

≤

v
i
l

,
l
∈
L
,
i
∈
N
,
{
i
,
j
}
∈
E




(26)






e

i
j

l

≤

v
j
l

,
l
∈
L
,
j
∈
N
,
{
i
,
j
}
∈
E




(27)






e

i
j

l

=

e

j
i

l

,
l
∈
L
,
{
i
,
j
}
∈
E




(28)






e

i
j


≤


∑

l
∈
L




e

i
j

l



,
l
∈
L
,
{
i
,
j
}
∈
E




(29)






e

i
j

l

≤

e

i
j


,
l
∈
L
,
{
i
,
j
}
∈
E




(30)







∑

j
∈
N
(
i
)




e

i
j

l



≤
2
,
l
∈
L
,
{
i
,
j
}
∈
E




(31)






1
2



∑

{
i
,
j
}
∈
E




e

i
j

l




+
1

=


∑

i
∈
N




v
i
l



,
l
∈
L




(32)







∑

l
∈
L




v
i
l



≤
a
,
i
∈
N
,
{
i
,
j
}
∈
E




(33)







∑

l
∈
L




e

i
j

l



≤
b
,
{
i
,
j
}
∈
E




(34)

Equations (26) and (27) indicate that if the station
i
 or station
j
 is not on the line
l
, the section

{
i
,
j
}

 will not on the line
l
. Equation (28) indicates that the network is regarded as undirected graph. Equations (29) and (30) indicate that if the network has the section

{
i
,
j
}
∈
E

, multiple lines in the network are allowed to pass through the section

{
i
,
j
}

. Equations (31) and (32) indicate that the line
l
 has neither branches nor loops. Equation (33) indicates that there are up to
a
 lines have the station
i
 in the network. Similarly, Equation (34) indicates that there are up to
b
 lines have the section

{
i
,
j
}

.Constraint 2: Passenger flow balance.






∑

l
∈
L





∑

i
:
{
i
,
k
}
∈
E




f

i
k


w
p
l




−




∑

l
∈
L





∑

j
:
{
k
,
j
}
∈
E




f

k
j


w
p
l




=



{



−
1
,
k
∈

O
w





1
,
k
∈

D
w





0
,
e
l
s
e




,
w
∈
W
,
p
∈

N
p





(35)






f

i
j


w
p
l


+

f

j
i


w
p
l


≤

e

i
j

l

,
l
∈
L
,
{
i
,
j
}
∈
E
,
w
∈
W
,
p
∈

N
p





(36)

Equation (35) indicates that for OD pair
w
, if station
k
 is the departure station


O
w


, there is only the inflow at the station; if station
k
 is the intermediate station, the inflow is equal to the outflow at the station; if station
k
 is the terminal station


D
w


, there is only outflow at the station. Equation (36) indicates that there is no backflow in the line
l
.Constraint 3: Matching degrees between network and urban characteristics.





m

C
min


≤

m
C

≤
1




(37)






m

F
min


≤

m
F

≤
1




(38)

Equations (37) and (38) indicate that the matching degrees


m
C


 and


m
F


 should meet the upper and lower limits, respectively.Constraint 4: Line alignments.In Figure 9,
i
,
j
 and
k
 represent three adjacent stations in line
l
.
α
 is the angle between the vectors



j
i

→


 and



j
k

→


. In order to ensure the line alignment goes smoothly, the angle
α
 between the adjacent sections should not be too small, as seen in Equation (39).




c
≤
α
≤
π




(39)

The cosine of the angle between the vectors



j
i

→


 and



j
k

→


 can be easily calculated by Equation (40). So Equation (39) can be expressed by Equation (41).




cos
α
=


(

x
i

−

x
j

)
(

x
k

−

x
j

)
+
(

y
i

−

y
j

)
(

y
k

−

y
j

)






(

x
i

−

x
j

)

2

+


(

y
i

−

y
j

)

2







(

x
k

−

x
j

)

2

+


(

y
k

−

y
j

)

2









(40)


where

(

x
i

,

y
i

)

,

(

x
j

,

y
j

)

 and

(

x
k

,

y
k

)

 are the coordinate pairs of station
i
, j and
k
, respectively.




c
≤
arccos
α
≤
π




(41)

Constraint 5: Network size.





N

n
o
d
e
s
min

l

≤

N

n
o
d
e
s

l

≤

N

n
o
d
e
s
max

l

,
l
∈
L




(42)






d

min

l

≤


∑

{
i
,
j
}
∈
E




d

i
j





e

i
j

l

≤

d

max

l

,
l
∈
L




(43)






N

l
min


≤

|
L
|

≤

N

l
max






(44)

Equations (42)–(44) indicate that the number of stations in line
l
, the length of line
l
 and the number of lines in the network should meet the upper and lower limits, respectively, where


N

n
o
d
e
s

l


 is the number of stations in the line
l
.Constraint 6: Capacity of sections.






∑

w
∈
W





∑

p
∈

N
p





g
w


P

w
p



f

i
j


w
p
l






≤

C

i
j


,
l
∈
L
,
{
i
,
j
}
∈
E




(45)

Equation (45) indicates that cross-sectional passenger volume of sections in each line is less than


C

i
j



. 4. Neighborhood Search AlgorithmThe problem dealt with in this paper is NP-hard. It has high structural complexity, multiple constraints and large search space, etc. So a neighborhood search algorithm [7] is developed based on a simulated annealing algorithm. A simulated annealing algorithm is a random optimization algorithm based on a Monte Carlo iterative solution strategy, and has strong robustness, global convergence and wide adaptability, which is suitable for solving the problem.In order to obtain a variety of perturbation solutions in the iteration process, four neighborhood transform operators are designed. The functions of these operators are as follows: adding a line randomly, deleting a line randomly, adding a section in a line randomly and deleting a section in a line randomly, as shown in Figure 10, Figure 11, Figure 12 and Figure 13. Different neighborhood transform operators are executed according to a certain probability. Different types of perturbations are randomly applied to the current solution


G

c
u
r
r



 to obtain new solution


G

n
e
w



. Each operator can be executed independently or simultaneously, for example, one line can be added while another line can be deleted at the same time.Let

f
(

G

c
u
r
r


)

,

f
(

G

n
e
w


)

 and

f
(

G

b
e
s
t


)

 be the objective function values of the current solution


G

c
u
r
r



, the new solution


G

n
e
w



 (perturbation solution) and the optimal solution


G

b
e
s
t



 in the existing iteration process, respectively. If

f
(

G

n
e
w


)
>
f
(

G

c
u
r
r


)

,


G

n
e
w



 is accepted as the new current solution. Otherwise,


G

n
e
w



 is accepted according to the Metropolis criterion. Metropolis criterion is that the algorithm allows the inferior solution to be accepted with a certain probability, so that the algorithm can jump out of the trap of the local optimum. The acceptance probability in the criterion is calculated by Equation (46). As the temperature decreases, the probability of accepting an inferior solution decreases gradually.





p
r

=

e

[
f
(

G

n
e
w


)
−
f
(

G

c
u
r
r


)
]
/
τ






(46)


where
τ
 is the current temperature.The algorithm is designed with the memory function of the optimal solution


G

b
e
s
t



 in the existing iteration process, that is, to remember the ‘best so far’ state. As the iteration proceeds, the solution


G

b
e
s
t



 in the memory base is continuously updated until the algorithm converges. Therefore, the objective value will approach the global optimum gradually in the iterative process. A solution has many kinds of changes after perturbation, so even if the current solution is perturbed into the solution that has appeared in previous iterations, it will change in other directions when perturbed again, which will not have a negative impact on the results. The overall flow of the algorithm is shown in Figure 14. 5. Real-World Case Application 5.1. Basic NetworkBaotou, which is a prefecture-level city in Inner Mongolia, has the total area of over 2000 square kilometers. The urban area was divided into 433 traffic zones, and 64 locations of large traffic volume were selected in the urban central area, as shown in Figure 15. The urban passenger corridors determined using the ‘cobweb assignment method’ are shown in Figure 16. As can be seen, the urban passenger corridors are mainly located in the east–west axis. According to the passenger corridors and the main axis of urban development, the basic network is formed using the method presented in Section 2.2.1, as shown in Figure 17. 5.2. ParametersIn the algorithm, the annealing rate
ϕ
 is set to 0.9, and the maximum number of iterations is set to 500. In this case, the passenger’s transfer sensitivity
λ
 is set to 0. The values of other parameters in the model are shown in Table 4. 5.3. Urban Characteristic IndexesThe trip intensity in the long-term planning year in the traffic zones is shown in Figure 18. According to the centroid coordinates of each traffic zone, the gravity center of urban trip intensity is calculated. The land-use intensity of the traffic zones in the long-term planning year is predicted, as shown in Figure 19. As we can see from Figure 18 and Figure 19, there is a strong correlation between the trip intensity and the land-use intensity in the traffic zones.The city is divided into multiple circles centered at the gravity center


O
P


 by the radii with different lengths, and the difference in length between adjacent circles is 500 m. From Figure 19, we can see that the city does not develop evenly in all directions. Therefore, it is necessary to divide the city into different areas and calculate the fractal dimension of land-use intensity in each area separately. In this paper, the city is divided into four areas using four quadrants, as shown in Figure 20.Taking logarithms on both sides of Equation (14), Equation (47) can be obtained. We can see that the fractal dimension


D
p


 can be got by linear regression.




ln
P
(
r
)
=

D
p

ln
r
+

a
0





(47)


where


a
0


 is a constant.The double logarithmic relationships between land-use intensity and radii in the areas of four quadrants are recorded, and the fractal dimension of land-use intensity in each quadrant is obtained by regression fitting, as shown in Figure 21. As we can see from the fitting coefficients, the calculated fractal dimension vector of land-use intensity is



D


P


=
(
1.506
,
1.509
,
1.549
,
1.131
)

. The fractal dimensions are less than 2. So according to Equation (16), we can see that urban land-use intensity gradually decreases from the city center to the outside, and the decreasing trend of the area in the fourth quadrant is the fastest. 5.4. ResultsBased on the model and algorithm, the real-world case is calculated and the optimal solution in the existing iteration process (called optimal solution for short) is obtained. The optimal objective value Z is about 8664.2. The first objective value


Z
1


 is about 32,287 while the second objective value


Z
2


 is about 35,207. The iterative process of the algorithm is shown in Figure 22. As can be seen, the algorithm can converge quickly and has strong stability.The optimal network is shown in Figure 23. The optimal network has 5 lines with a total length of 110.6 km, and the details of the lines is shown in Table 5. The network presents the radial structure as a whole, and the central area is supplemented by a grid-like structure. The distance between the gravity center


O
S


 of stations’ importance distribution and the gravity center


O
P


 of urban trip intensity is about 973.9 m, as shown in Figure 23. The matching degree


m
C


 between the optimal network and the urban trips is about 0.947, and the matching degree


m
F


 between the optimal network and the urban land use is about 0.893. In general, the network takes the east–west direction as the main axis, and the line alignments basically follow the routes covered by the main passenger flow corridors, which conforms to the banded development requirement of the city. The results showed that the layout of the network has a good match with the structure of the city. 6. ConclusionsIn this paper, a quantitative model is developed to ensure that the generated urban rail transit network has a good match with urban road network, trips and land-use characteristics. The main contributions of the model are as follows:The basic network, which is determined according to the main locations of large traffic volume and main passenger flow corridors, is constructed to ensure matching between the network and the urban road network. With the basic network, the search range and the search direction of the line alignments can be bounded while generating the transit network. The matching index, which is calculated by the deviation value between two gravity centers of the stations’ importance distribution in the network and the traffic zones’ trip intensity, is proposed to constrain the matching degree between the network and the urban trip demand.Similarly, the matching index, which is calculated by the deviation value between the fractal dimensions of stations’ importance distribution and the traffic zones’ land-use intensity, is proposed to constrain the matching degree between the network and the land use.To solve the model, a neighborhood search algorithm is developed based on the simulated annealing method. A real-size network is calculated with the model and algorithm. The generated network conforms to the development requirement of the city, which shows a good match between the network and the urban characteristics.
