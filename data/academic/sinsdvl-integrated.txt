 1. IntroductionAutonomous underwater vehicles (AUVs) play an important role during the exploration, development, and utilization of ocean resources in the military and national economy [1,2,3]. Examples are underwater sensing, observation of sea-bottom landforms, detection of specific objects, and submarine cable patrol [4,5,6]. During these operations, AUVs must know their own location and where to go, so underwater positioning technology is critical in order for underwater vehicles to safely and effectively perform their missions. However, the traditional positioning methods that are used on land cannot be used underwater and, because of the rapid attenuation of electromagnetic waves in water, the global satellite navigation system that is commonly used on land cannot be used underwater, so it is a challenge to position AUVs [7,8].Underwater positioning methods can be classified into three groups [9,10]: dead reckoning and inertial navigation; acoustic navigation; and geophysical navigation. These positioning methods can be utilized independently or in combination to achieve integrated navigation and improve navigation accuracy. In integrated underwater navigation, the methods that are currently popular integrate the positioning of the strapdown inertial navigation system (SINS) and the Doppler velocity log (DVL) [11,12,13,14,15,16]. Ever since the successful application of this technology in the MARIDAN AUV in Denmark at the beginning of this century [13], after more than 10 years of development, it has achieved fruitful research results in several key technologies. However, due to the complex working environment, long working distances, random drift of the gyro, gradual divergence in the positioning error over time, and uncertain factors, the positioning stability and accuracy are limited and cannot meet the requirements of many marine applications. Many research works have been conducted to improve underwater positioning performance. As the positioning error resources are not considered, these improvements do not show promise. In this paper, considering positioning error resources and their impact on the positioning result, we propose a SINS/DVL integrated positioning system based on filtering gain compensation adaptive filtering technology.In this paper, we make the following contributions:(1)For the fusion of positioning information, we present a general framework for an integrated positioning fusion system based on adaptive Kalman filtering. It provides a general reference for information fusion methods.(2)We take full advantage of strong tracking filtering and adaptive filtering to propose and utilize an organic combination of a filtering gain compensation adaptive filter and a filtering gain compensation strong tracking filter to fuse the positioning information to obtain higher accuracy and a more stable positioning result.(3)The proposed SINS/DVL integrated positioning system based on a filtering gain compensation adaptive filter can enhance underwater positioning performance and also provides reference value for other information fusion systems. 2. Related WorksDifferent types of positioning sub-systems have been integrated regarding their respective advantages and disadvantages by appropriate methods, in order for integrated positioning systems to offer complementary advantages in performance and provide better positioning performance than any single type of positioning system [1]. At present, the mainstream integrated methods include inertial navigation and Global Positioning System (GPS), DVL, and astronomic navigation. All of these positioning methods and other Kalman-filtering-related technologies have been explored in positioning information fusion [17]. However, some issues remain with the existing integrated positioning methods. When using Inertial Navigation System (INS)/GPS integrated navigation, the satellite signal can easily be occluded and distorted, the autonomy and concealment are poor, and its correct use is subject to human defects. Although INS/GPS integrated navigation has the advantage of high navigation accuracy after combination, the above drawbacks also lead to a great reduction in the reliability and application range of this combination [1]. The combination of astronomy/inertia is subject to such conditions as meteorological conditions and signal distortion, which limits the application of this integrated method [18]. Compared with the above two combinations, Doppler/inertial integrated positioning has unique advantages. The combination of the two methods has strong autonomy and concealment [19]. It can operate autonomously without external signal inputs, and the reliability is very high [20,21]. However, the amount of position information will decrease as the working time increases, which is the disadvantage of this combination method [22].As inertial positioning systems have strong concealment and autonomy under water, they comply with the requirements of most modern underwater vehicles. Additionally, when an acoustic signal propagates in seawater, the signal attenuation decreases and the propagation distance increases. A combination of positioning systems is more widely used. The Kalman filter (KF) is a well-known powerful processing method, and has been well studied. In 1998, Savkin et al. presented a robust state estimation approach for a class of uncertain discrete-time systems with a deterministic description of noise and uncertainty. In this method, a recursive scheme was utilized to construct an ellipsoidal state estimation set of all states consistent with the measured output. And the result is promising [23]. In 2001, considering the uncertain parameters, [24] proposed a new approach to finite-horizon guaranteed state prediction for discrete-time systems affected by bounded noise and unknown-but-bounded parameter uncertainty. Wang et al. presented an adaptive robust Kalman filtering algorithm. The algorithm explores a one-step predictor-corrector structure to minimize the mean square estimation error, so as to address the estimation problem the estimation problem that arises in linear time-varying systems with stochastic parametric uncertainties in 2002 [25]. To guarantee an optimized upper bound on the state estimation error covariance despite the model uncertainties as well as the linearization errors, Kai et al. presented a novel robust extended Kalman filter (REKF) for discrete-time systems with stochastic uncertainties in 2009 [26]. In 2015, Gao et al. proposed an adaptive KF with a recursive noise estimator based on a maximum posterior estimation and one-step smoothing filtering. Adaptive filtering provides good noise parameters for a KF. The new SINS/DVL system can handle violent maneuvers and complex sea conditions very well [27]. In 2018, aiming at the problem of the low precision of the conventional filtering algorithm in the strap down inertial navigation/Doppler integrated positioning system, Guo proposed a square root unscented information filter, which reduces the computational complexity of the system while obtaining higher positioning accuracy. The results show that the tracking accuracy of the integrated positioning system is much higher than that of the SINS alone [28]. Different from previous works, in this paper, considering the parameter uncertainties and model uncertainties, we take full advantage of an organic fusion of strong tracking filtering and Sage–Husa adaptive filtering to achieve robust Kalman filtering for the SINS/DVL integrated positioning system. What is more important is that, we utilize an exponent filtering gain compensation strategy to quickly track the system state in real time, minimize the state estimation error and reduce the speed of the error accumulation. More specifically, when the initial motion state changes significantly, we increase the filter gain with an exponent compensation to enhance the effect of the new information according to the obtained observation value information. After the system is stabilized, we decrease the filter gain to ensure the optimal filtering of the system.In the SINS/DVL integrated positioning system, the SINS has a fully autonomous navigation capability and meets the concealment requirements of underwater vehicles, so it is widely used in related fields. However, due to an underwater environment’s complexity and random drift of the gyro, using only a SINS will cause the navigation error to gradually diverge over time. Using the Doppler effect, DVL calculates the velocity of the carrier relative to the ground through an echo that transmits the beam obliquely below the carrier, providing high-precision velocity information. Therefore, SINS and DVL were integrated to form a SINS/DVL integrated navigation system. However, information on the speed of the DVL’s output can only suppress the divergence of the SINS positioning error to a limited extent. In this study, we consider the positioning parameter filtering problem in the SINS/DVL integrated positioning system and enhance the system’s positioning accuracy and stability. 3. SINS/DVL Integrated Positioning System Based on a Filtering Gain Compensation Adaptive Kalman FilterIn this section, we first illustrate the framework for the SINS/DVL integrated navigation system based on a filtering gain compensation adaptive Kalman filter. Then, we describe each sub-module and its implementation. 3.1. Framework for the SINS/DVL Integrated Positioning SystemThe framework for the SINS/DVL integrated positioning system is shown in Figure 1. It is composed of three sub-systems: the Strapdown Inertial Navigation Subsystem and Error Analysis sub-module, the Doppler Velocity Log Subsystem and Error Analysis sub-module, and the SINS/DVL integrated filter sub-module.The Strapdown Inertial Navigation system and Error Analysis sub-module provides pure inertial positioning results to the SINS/DVL filter. The inertial navigation system error is used to estimate the navigation parameters in the mechanical programming of the inertial navigation system as feedback correction. In practical applications, feedback correction is generally used; however, Kalman filtering takes time to stabilize, and the error is very large at first, which leads to a decrease in system accuracy and is not suitable for feedback. To address these issues, we use a combination of output correction and feedback correction.The Doppler Velocity Log Subsystem and Error Analysis sub-module provides high-precision velocity information and performs an error analysis in DVL. In this system, we utilized the difference in value between the solution velocity of the strap down inertial navigation system and the velocity of the Doppler velocity log as the observation of the SINS/DVL filter.The SINS/DVL integrated filter sub-module is the positioning information fusion center. It is composed of a SINS/DVL integrated navigation error model and filtering gain compensation-based adaptive filtering. The SINS/DVL integrated navigation error model constructs the system state variable, the system state equation, and the system measurement equation. The filtering gain compensation-based adaptive filter performs data fusion and filtering. It is an organic combination of an adaptive filtering and a strong tracking Kalman filtering. We combine the inverse-free matrix with the improved adaptive filter, so a high positioning accuracy with stability and efficiency can be obtained.The SINS/DVL integrated positioning system is suitable for a remote AUV underwater navigation. When we describe the system’s dynamic characteristics and measurement equations, we divide the integrated navigation filtering methods into direct and indirect methods. Compared with the direct method, the indirect method has the characteristics of relatively high complexity and higher accuracy. We use the indirect filtering to obtain higher accuracy. The indirect filtering has output correction and feedback correction. Regarding the output correction, we use the inertial navigation system’s error estimation to correct the navigation parameters of the inertial navigation system. 3.2. Strapdown Inertial Navigation Subsystem and Error AnalysisThe strap down inertial navigation system consists of a three-axis accelerometer assembly and three orthogonal rate gyros. Without a solid platform, both the accelerometer and the inertial gyros are mounted on the target. The cost is lower, the structure is simpler, and the space utilization rate is higher; however, the calculation process is more complicated. To aid in computing, another important part of the Strapdown Inertial Navigation System is its computer.During the movement of the target, the installed gyroscope obtains the angular velocity of the aircraft relative to the inertial reference frame. Taking this into account, the transformation matrix of the coordinate system that corresponds to the target coordinate system can be calculated in order to obtain the three-axis accelerometer. The acceleration variable is fed back into the positioning coordinate system, and the specific navigation information is obtained through the final operation of the computer.During the navigation process, an underwater vehicle is equipped with an accelerometer and a gyroscope in the northeast direction of the navigation coordinate system. Let the acceleration of the carrier in the north direction be an. Similarly, the east acceleration and the vertical acceleration are recorded as ae and au, respectively. With the passage of time, the acceleration is integrated with time, and the velocity components in the three directions of the aircraft can be calculated:




{






v
e

(

t
k

)
=

v
v

(

t
0

)
+



∫


t
0




t
k





a
e

d
t










v
n

(

t
k

)
=

v
v

(

t
0

)
+



∫


t
0




t
k





a
n

d
t










v
u

(

t
k

)
=

v
v

(

t
0

)
+



∫


t
0




t
k





a
u

d
t













(1)

In the same way, to obtain the latitude, longitude, and depth of the aircraft on the earth, we can also obtain Equation (2) from Equation (1):




{





λ
=

λ
0

+



∫


t
0




t
k





λ
˙

d
t









j
=

j
0

+



∫


t
0




t
k





j
˙

d
t









d
=

d
0

+



∫


t
0




t
k





d
˙

d
t













(2)


where


λ
0


,


j
0


 and


d
0


 are the initial positions of the warp, weft, and depth of the aircraft, respectively, and

λ
˙

,

j
˙

 and

d
˙

 are the rates of change of the warp, latitude, and depth, respectively. The speed can be tracked in real time by the SINS/DVL combined positioning system, so the rate of change of warp, latitude, and depth can be extrapolated from speed as follows:




{






λ
˙

=



v
e



(
N
+
d
)
cos
φ









j
˙

=



v
n



M
+
d









d
˙

=

v
u







.




(3)

In the formula, in order to simplify the calculation, we approximate the Earth as a sphere with radius R. Then, M = N = R.The inertial navigation system requires a series of reference coordinate systems to define the position and state of motion of the aircraft. When the attitude calculation is performed on the mathematical platform, the reference system is converted. The common coordinate system of the SINS/DVL integrated navigation system is the local horizontal coordinate system.The horizontal coordinate system is the coordinate system of the relative geoid plane, which is also known as the geographic coordinate system. The origin is set at the center of the aircraft, and is also the projection of the origin of the inertial platform on the geoid level. The direction axes of the horizontal coordinate system point to the north, the east, and the sky. The e-axis points along the east direction of the reference ellipsoid circle (x-axis), the n-axis points along the meridian circle to the north direction (y-axis), and the u-axis points along the normal outside of the ellipsoid to the sky (z-axis). Sometimes the x, y, and z axes are referred to as the east–north–sky axis. Because of their widespread use in the navigation field, the horizontal coordinate system is also called the navigation coordinate system.The transformation matrix of the carrier coordinate system relative to the local horizontal coordinate system is as follows:





R

b
L

=

[





cos
r
cos
y
−
sin
r
sin
y
sin
p




−
sin
y
cos
p




cos
y
sin
r
+
sin
y
sin
p
cos
r






cos
r
sin
y
+
sin
r
cos
y
sin
p




cos
y
cos
p




sin
y
sin
r
−
cos
y
sin
p
cos
r






−
cos
p
sin
r




sin
p




cos
p
cos
r





]





(4)


where (r, p, y) are the roll angle, the pitch angle, and the heading angle of the underwater vehicle, respectively. We also call


R




b
L


 the attitude matrix.The error in the strap down inertial navigation system is mainly caused by the following four situations:
Errors caused by inertial sensors: Inertial sensors, such as accelerometers or gyroscopes, may cause errors due to processing, assembly processes, or principal problems. This type of error is called systematic error. In the Strapdown Inertial Navigation/Doppler Velocity Logger integrated positioning system, such errors account for 90% of the total error.Errors in the computer operation process: The Strapdown Inertial Navigation System outputs the acceleration and attitude angles of the gyroscope and accelerometer, and the rest of the computational work is done by the computer. The calculation error includes the error in the Strapdown Inertial Navigation System and the error in the Kalman filter.Errors caused by mathematical models: When establishing the system model, we approximate the earth as a sphere in the calculation process. When using Newton’s second law as the inertial motion equation, and the speed of the aircraft is very high, the description of the aircraft’s motion will be insufficiently accurate.Errors caused by the initial alignment: These errors can be divided into the following:
(1)Installation errors. Gyros and accelerometers can cause errors during installation.(2)Initial condition errors. Initial condition errors include heading, attitude and position, and zero errors in the gyroscope and accelerometer.(3)Calculation errors. The calculation errors of the navigation system are also called the calculation errors of the mathematical platform.(4)Instrument errors. This refers mainly to the errors in the drift that is generated by the gyroscope and the accelerometer and the error in the angular rate meter.In the SINS/DVL integrated filter’s design, we consider these error sources and take steps to minimize their negative effect in order to obtain a stable and accurate positioning result. 3.3. Doppler Velocity Log Subsystem and Error AnalysisThe Doppler log operates by the phenomenon of the aircraft generating a Doppler shift during the ultrasonic wave’s movement to the sea floor. The Doppler effect refers to a phenomenon in which the frequency of the acoustic wave that is received by the observing object (or the observed object) and the frequency of the emitted sound wave are different when the observing object (or the observed object) moves relative to the reference medium. The Doppler log provides a standard speed relative to the acoustic wave source in the carrier coordinate system during normal operation. The standard speed that is provided includes not only information on the forward motion of the aircraft relative to the submarine base, but also the current aircraft, the drift angle of the heading, and information on the lateral displacement velocity that is caused by the influence of the ocean current relative to the seabed base.The DVL receiver and transmitter are typically fixed on the same AUV, with the AUV moving at a speed ν relative to the seafloor reflection point. The acoustic frequency of the DVL is f. The acoustic frequency received by the reflection point at the bottom of the sea is f’, and the acoustic beam propagates in the water at the speed of ν0. According to the Doppler shift formula, the following formula is given:




f
′

=

v

v
−

v
0



f
.




(5)

The frequency of the received acoustic beam from the seafloor reflection is f′, and the sound frequency of the DVL that is captured by the underwater vehicle during the movement is f″, which is:




f
″

=


v
+

v
0


v


f
′

=


v
+

v
0



v
−

v
0



f
.




(6)

According to (6), the Doppler shift is:




f
d

=

f
″

−
f
=


2

v
0



v
−

v
0



f
.




(7)

After integrating the above, we can obtain the speed formula of the aircraft as follows:



v
=
(
1
+


2
f



f
d



)

v
0

.




(8)

The Doppler log not only measures the speed of the underwater vehicle’s forward and reverse motion, but also measures the speed of the underwater vehicle’s lateral displacement. The navigation system that is realized by Doppler log meets the requirements for remote underwater navigation without relying on external equipment for independent navigation work and is not affected by the failure of navigation base stations in the air and land. The impact of the visual visibility can also be completely ignored because of Nano positioning. At the same time, the Doppler sonar can provide a more accurate measurement of speed in a shallow water environment when the aircraft is in low-speed operation. The lowest measurable speed is 0.005 m/s. The shallowest water depth is between 0.3 and 0.5 m. In many cases, autonomous vehicles navigate at a relatively low speed. Under the premise of low-speed navigation, the Doppler log can also maintain sufficient sensitivity for positioning work. Although the Doppler velocimeter uses a sound wave signal to perform navigation speed measurements, since the angle of injection into the sea floor is steep, it still maintains good concealment. The anti-interference is strong, the sensitivity is high, and the speed measurement’s accuracy is higher. However, the Doppler log requires an external vertical reference and heading information during actual navigation work, which is why the Doppler log and the strap down inertial navigation system were integrated. Since the SINS/DVL integrated positioning system belongs to an externally independent dead reckoning system, positioning errors will also accumulate over time. If a remote autonomous underwater vehicle based on the Strap Down Inertial Navigation/Doppler Logger Integrated Positioning System is used to perform a task, it is necessary to periodically perform positioning correction by means of the “Snorkeling–Surface Correction–Submarine” GPS positioning system. The calibration period is long, so it does not affect the long-lasting endurance and navigation independence of the integrated positioning system.According to the working principle of the DVL, the DVL can obtain information on the speed and drift angle of an AUV relative to the seabed. The underwater vehicle speed



V
˜

d


 and drift angle

δ
˜

 error equations are as follows:




δ
˜

=
δ
+
δ
Δ




(9)








V
˜

d

=
(
1
+
δ
C
)

V
d

+
δ

V
d

.





(10)

In the formulae,

δ
Δ
1

,

δ

V
d


, and

δ
C

 are the bias angle error, the velocity error, and the coefficient error of the AUV, respectively. Based on the actual operating environment of the Doppler log, we take

δ

V
d


 and

δ
Δ

 as first-order Markov processes.

δ
C

 is a constant. Then, we can obtain:



δ


V
˜

d

=
−

β
d

δ

V
d

+

ω
d





(11)





δ

Δ
˙

=
−

β
d

δ
Δ
+

ω
Δ





(12)





δ

C
˙

=
0




(13)


where


β
d

−
1



 and


β
Δ

−
1



 are the correlation times of the velocity offset error and the drift angle error, respectively, and


ω
d


 and


ω
Δ


 are white noise. 3.4. SINS/DVL Integrated Adaptive FilterIn this section, we first establish the integrated navigation error model. Then, we describe the filtering gain compensation adaptive Kalman filter algorithm that we use to process and fuse the positioning information. 3.4.1. Establishment of the Navigation Error ModelThe error model of the integrated navigation system is composed of a strapdown inertial navigation system error model and a Doppler log error model. A long distance underwater vehicle has a long working distance. Based on the above characteristics, we chose the positioning error, velocity error, misalignment angle, gyro drift, speed offset error, drift angle error, and scale factor error as the state quantities for the filtering. The gyro drift model is described by a first-order Markov model. For the Doppler log, it provides the system with the velocity and drift angle of the carrier relative to the seabed. The measurement error is divided into the drift angle error, the velocity error and the scale factor error, which are also defined by the first-order Markov model.The system state variable in the error model is


X

=


[
δ

v
E

 
δ

v
N

 
α
 
β
 
γ
 
δ
L
 
δ
λ
 

ε
E

 

ε
N

 

ε
U

 
δ

v
d

 
δ
Δ
 
δ
C
]

T


, where

δ

v
E


 and

δ

v
N


 are the east and north speed error, respectively,
α
,
β
, and
γ
 is the platform misalignment angle,

δ
L

 and

δ
λ

 are the latitude and longitude error, respectively,


ε
E


,


ε
N


, and


ε
U


 are the gyro drift,

δ

v
d


 is the measuring velocity offset error for the Doppler log,

δ
Δ

 is the bias angle error, and

δ
C

 is the scale factor error.(1) System State EquationThe east and north speed error formulae are given as follows:



δ

v
E

=



v
N




R
N



⋅
tan
L
⋅
δ

v
E

+
(
2
Ω
sin
L
+



v
E




R
N



⋅
tan
L
)
δ

v
N

+
(
2
Ω
cos
L

v
N

+



v
N


v
E




R
N



⋅


sec

2

L
)
δ
L
−
β
g
+
Δ

a
E





(14)





δ

v
N

=
(
2
Ω
sin
L
+



v
E




R
N



⋅
tan
L
)
δ

v
E

+
(
2
Ω
cos
L

v
E

+



v
E
2




R
N



⋅


sec

2

L
)
δ
L
+
α
g
+
Δ

a
N

.




(15)

The platform misalignment angles are defined as follows:



α
=
−


δ

v
N


R

−
γ
(
Ω
cos
L
+



v
E


R

)
+
β
(
Ω
sin
L
+



v
E


R

tan
L
)
+

ε
E





(16)





β
=
−
α
(
Ω
sin
L
+



v
E


R

tan
L
)
−
δ
L
Ω
sin
L
+


δ

v
E


R

−
γ



v
E


R

+

ε
N





(17)





γ
=
δ
L
(
Ω
cos
L
+



v
E


R



sec

2

L
)
+


δ

v
E


R

tan
L
+
β



v
N


R

+
α
(
Ω
cos
L
+



v
E


R

)
+

ε
U

.




(18)

The positioning error is denoted as:



δ
L
=


δ

v
N


R





(19)





δ
λ
=


δ

v
E


R

sec
L
+



v
E


R

tan
L
sec
L
δ
L
.




(20)

The gyro drift is defined as follows:




ε
E

=
−

β
E


ε
E

+

w
E





(21)






ε
N

=
−

β
N


ε
N

+

w
N





(22)






ε
U

=
−

β
U


ε
U

+

w
U





(23)


where


β
E

−
1



,


β
N

−
1



, and


β
U

−
1



 are for the gyroscope in the east, the gyroscope in the north, and the direction of the error related to time.The speed, drift angle, and scale error of the Doppler log are given as follows:



δ

v
d

=
−

β
d

δ

v
d

+

w
d





(24)






δ
Δ
=
−

β
Δ

δ
Δ
+

w
Δ






(25)






δ
C
=
0
.





(26)

The state equation is described as:






X
˙



S
I
N
S
/
D
V
L


=


F


S
I
N
S
/
D
V
L




X


S
I
N
S
/
D
V
L


+


G


S
I
N
S
/
D
V
L




W


S
I
N
S
/
D
V
L






(27)

In the formula:





W


S
I
N
S


=



[




0


0




a
E






a
N




0


0


0



 

w
E

 

w
N

 

w
U

 

w
d

 

w
Δ

 
0

]


T

.




(28)

We establish a state transfer matrix according to Equations (14)–(28):




F

S
I
N
S
/
D
V
L


=

[







F


7
×
7















0

4
×
3







0

4
×
3


















I


3
×
3







0

3
×
3

















0

6
×
7








F


6
×
6







]





(29)


where:





F


7
×
7


=

[




0


0


0




F

14





0


0


0






F

21





0




F

23





0


0


0


0






F

31





0




F

33







F

34





0



−
g



0






F

41





0




F

43





0


g


0


0




0


0


0




F

54





0




F

56







F

57









F

61





0




F

63





0




F

65





0




F

67









F

71





0




F

73





0




F

75







F

76





0




]





(30)

In matrix



F


7
×
7



,


F

14


=

1
R


,


F

21


=



V
E


R

tan
L
sec
L

,


F

23


=


sec
L

R


,


F

31


=
(
2
Ω
cos
L
+



V
E


R



sec

2

L
)

V
N


,


F

33


=



V
N


R

tan
L

,


F

34


=
2
Ω
sin
L
+



V
E


R

tan
L

,


F

36


=
−
g

,


F

41


=
(
2
Ω
cos
L
+



V
E


R



sec

2

L
)

V
E


,


F

43


=
−
(
2
Ω
sin
L
+



V
E


R



sec

2

L
)

V
E


,


F

45


=
g

,


F

54


=
−

1
R


,


F

56


=
Ω
sin
L
+



V
E


R

tan
L

,


F

57


=
−
(
Ω
cos
L
+



V
E


R

)

,


F

61


=
−
Ω
sin
L

,


F

63


=

1
R


,


F

65


=
−
(
Ω
sin
L
+



V
E


R

tan
L
)

,


F

67


=



V
N


R


,


F

71


=
Ω
cos
L
+



V
E


R



sec

2

L

,


F

73


=


tan
L

R


,


F

75


=
Ω
cos
L
+



V
E


R


,


F

76


=



V
E


R


.






F


6
×
6


=

[





−

β
E




0


0


0


0


0




0



−

β
N




0


0


0


0




0


0



−

β
U




0


0


0




0


0


0



−

β
d




0


0




0


0


0


0



−

β
Δ




0




0


0


0


0


0


0




]






(31)

(2) System Measurement EquationSince we use the difference in value between the solution speed of the strap down inertial navigation system and the speed of the Doppler log as the observation of the measurement equation, the system measurement equation is:





Z


S
I
N
S
/
D
V
L


=

[





δ

v
E

−
δ

v

d
E








δ

v
N

−
δ

v

d
N







]

=


H


S
I
N
S
/
D
V
L




X


S
I
N
S
/
D
V
L


+


V


S
I
N
S
/
D
V
L






(32)

In Equation (32):





H


S
I
N
S
/
D
V
L


=

[




0


0


1


0


0


0



−

v
N




0


0


0



−
sin

K
d





−

v
N





−

v
E






0


0


0


1


0


0




v
E




0


0


0



−
cos

K
d






v
E





−

v
N






]

.




(33)







V


S
I
N
S
/
D
V
L


=


[





v
E






v
N





]

T





(34)

Here, the system noise variance matrix is:




Q

=
d
i
a
g
(

R

δ

V
E



 







R

δ

V
N



 







R
α

 







R
β

 






 

R
γ

 






 

R

δ
L


 






 

R

δ
λ


 






 

R

ε
E


 






 

R

ε
N


 






 

R

ε
U


 






 

R

δ
V
d


 







R

δ
Δ


 







R

δ
C


)
.




(35)

The measurement noise variance matrix is:




R

=
d
i
a
g
(





R


V
N








R


V
E







)
.




(36)

 3.4.2. Filtering Gain Compensation-Based Adaptive Kalman Filter(1) Workflow of the Filtering Gain Compensation Adaptive FilterFigure 2 shows the workflow of the filtering gain compensation adaptive filtering algorithm. The filtering gain compensation algorithm was combined with the filtering gain compensation adaptive filter and the filtering gain compensation strong tracking Kalman filter. After filter initialization and parameter setting, we calculate the AUV’s state of motion using the Kalman filter, and judge whether the filter procedure is convergent or not, i.e., we determine whether the estimated error value is much larger than the error’s expected value or not. If it is, we use the filtering gain compensation adaptive Kalman filter to filter the position information. Otherwise, we utilize the filtering gain compensation strong tracking Kalman filter. Lastly, if the time period ends, we come to the procedure’s end. Otherwise, we perform the filter gain compensation adaptive filtering iteratively.(2) Filtering Gain CompensationWhen a Kalman filter is used for the long-range underwater dynamic tracking of an AUV, if the external interference in the underwater current or the speed and course of the underwater vehicle experience a sudden change, the estimated value from the filtering process will be slightly delayed when tracking the real state of the underwater vehicle. This will reduce the navigation accuracy and quality.In the process of Kalman filtering, filtering gain and the one-step predicted value are the main factors that lead to the failure of state estimation to track the real state of the vehicle in time. For state estimation, the filtered gain



K

k


 represents the action strength of the information residual. If the



K

k


 value is large, the correction of the estimated value at the next moment will be large. In contrast, if



K

k


 is small, the predicted value at the current moment will be more accurate. Therefore, the degree to which the actual state of motion at the moment k+1 coincides with the estimation of the optimal state of motion is directly related to the correction of the state estimation by the filtering magnification factor



K

k


.When the Kalman filter and the positioning system are stable, the real state of the system corresponds to the one-step predicted state value. Due to the small size of the error, the correction of




X
^



k
,
k
−
1



 is small. However, due to the changes in the system state during the filtering process, the estimate fails to follow the change in the target’s maneuvers. The reason for this is that, in the estimation of the next moment, the system is always judged according to its previous state, and the state transition matrix at the previous moment is used to calculate the predicted state variables at the next moment, which will inevitably lead to the gradual accumulation of errors.In order to quickly track the system state in real time and reduce the speed of error accumulation, we can improve the filter gain



K

k


.We can obtain the required observation values from the sensors (such as the velocity as displayed by the Doppler log or the attitude angle and acceleration as displayed by the SINS inertial navigation system). The error caused by the correlation between the observed value and the system is relatively small. We can increase the filter gain value



K

k


 and enhance the effect of the new information according to the obtained observation values. In addition, the covariance error matrix


P
k


 in the filtering process is also related to the filtering gain; an increase in


P
k


 will result in an increase in



K

k


. Since


P
k


 is the covariance matrix of the error,


P
k


 is also the embodiment of the filtering accuracy. If



K

k


 is appropriately increased, the filtering correction will be large and the error covariance matrix


P
k


 will also be large.To let the improved filter gain

K

 be



K

n


, and, on the basis of the original gain, we add to

K

 a supplementary term



K

g


, as shown in Equation (37):




K
n

(
k
)
=
K
(
k
)
+

K
g

(
k
)
.




(37)

In Equation (37),


K

(
k
)

 is still calculated in the traditional way, and the corresponding filtering equation is updated as follows:





K
^


(
k
+
1
)
=


K
^


(
k
+
1
/
k
)
+


K
^


(
k
+
1
)
[


Z
^


(
k
+
1
)
−


Z
^


(
k
+
1
/
k
)
.




(38)

In order to make the stabilized system filter optimally, it is necessary for



K

n


 to increase the tracking performance over time when the initial state of motion changes significantly. After the system is stabilized,



K

n


 can be reduced to



K

g


 to ensure that the system is optimally filtered, as shown in (39):




K
g

=

K
z


λ

(
k
−

k
0

)


.




(39)


λ
 must be less than 1 in order to ensure that the filter gain of the vehicle increases rapidly at the moment of an abrupt transition and then decreases rapidly in order to ensure that the optimal filter conditions are satisfied. The size of
λ
 also reflects the speed of the change in the filter gain.


k
0


 denotes the time when the navigation system detects a sudden change in the state of motion of the vehicle, and


P
k


 represents the deviation in the error of the state variable in the filtering process. In the case of a sudden change at


k
0


, a large


P
k


 will be selected because the tracking response of the system is not timely and the error is large. The expressions of the covariance matrix and the filter gain at this time are as shown in (40) and (41):




P
z

(

k
0

)
=
Φ
(

k
0

,

k
0

−
1
)

P
z


Φ
T

(

k
0

,

k
0

−
1
)




(40)







K
=
H

(

k
0

)

H
T

(

k
0

)


[
H
(

k
0

)

P
z

(

k
0

)

H
T

(

k
0

)
]


−
1


.





(41)

(3) Adaptive Kalman Filter To improve the stability, minimize the error, and restrain the divergence of the dynamic filtering, the Sage–Husa adaptive filter add statistical characteristics of noise to the observation data when estimating the observation of system state at the next moment. We estimate and correct the status of the observation noise and system noise over time. The discrete time linear system is defined as follows:




X
k

=

F

k
,
k
-
1



X

k
-
1


+

G

k
-
1



W

k
-
1






(42)






Z
k

=

H
k


X
k

+

V
k





(43)


where


W
k


 and


V
k


 are normal white noise series:




{





E
[

W
k

]
=

q
k





E
[

W
k


W
j
T

]
=

Q
k


d

k
j








E
[

V
k

]
=

r
k





E
[

V
k


V
j
T

]
=

R
k


d

k
j








E
[

W
k


V
j
T

]
=
0













(44)

The Sage–Husa adaptive filter algorithm can be expressed as follows:





X
^

k

=


X
^


k
,
k
-
1


+

K
k



Z
˜

k





(45)








X
^


k
,
k
-
1


=

F

k
,
k
-
1




X
^


k
-
1


+


q
^

k






(46)








Z
^

k

=

Z
k

-

H
k



X
^


k
,
k
-
1


-


r
^

k






(47)







K
k

=

P

k
,
k
-
1



H
k
T



(

H
k


P

k
,
k
-
1



H
k
T

+


R
^

k

)


-
1







(48)







P

k
,
k
-
1


=

F

k
,
k
-
1



P

k
,
k
-
1



F

k
,
k
-
1

T

+


Q
^


k
-
1







(49)







P
k

=
(
I
-

K
k


H
k

)

P

k
,
k
-
1


.





(50)

Here,



r
^

k


,



R
^

k


,



q
^

k


, and



Q
^

k


 can be estimated by the time variable estimation equation:





r
^


k
+
1


=
(
1
-

d
k

)


r
^

k

+

d
k

(

Z

k
+
1


-

H

k
+
1
,
k




X
^


k
+
1
,
k


)




(51)








R
^


k
+
1


=
(
1
-

d
k

)


R
^

k

+

d
k

(


Z
˜


k
+
1




Z
˜


k
+
1

T

-

H

k
+
1
,
k



P

k
+
1



H

k
+
1

T

)





(52)








q
^


k
+
1


=
(
1
-

d
k

)


R
^

k

+

d
k

(


X
^


k
+
1


-

F

k
+
1



X
^

)





(53)








Q
^


k
+
1


=
(
1
-

d
k

)


Q
^

k

+

d
k

(

K

k
+
1




Z
˜


k
+
1




Z
˜


k
+
1

T


K

k
+
1

T

+

P

k
+
1


-

F

k
+
1



P
k


F

k
+
1

T

)
.





(54)

We call


d
k

=
(
1
−

d
k

)
/
(
1
−

b

k
+
1


)
,
 
0
<
b
<
1

 the “forgetting factor. The status variables of the navigation system have many reference values, which leads to the system status variables having high dimensions. At the same time, the variance in the noise estimation value needs to be calculated during filtering. The number of required calculations is very high. So, the filter cannot track the status variable in real time and the stability of the system cannot be guaranteed.(4) Strong Tracking Kalman FilterIn order to ensure the reliable convergence of the filter, some accuracy can be sacrificed to ensure that the filter remains stable. In strong tracking Kalman filtering, we consider the error during the modeling of the system by adding an observation noise series and a process noise series. More specifically, the pre-covariance matrix of the state estimation error is multiplied by a weighted coefficient to maintain the ability to track abrupt changes in the system state.Suppose the weighted coefficient is



λ


K
+
1



. Then, the weighting process can be expressed as follows:




P

k
,
k
−
1


=

λ

k
−
1



Φ

k
,
k
−
1



P

k
,
k
−
1



Φ

k
,
k
−
1

T

+


Q
^


k
−
1






(55)

For the weighted coefficient algorithm:





λ


k
+
1


=
d
i
a
g
[

λ

1
(
k
+
1
)


,

λ

2
(
k
+
1
)


,
…
,

λ

m
(
k
+
1
)


]




(56)







λ


i
(
k
+
1
)


=

{






α
i


C

k
+
1


(

α
i


C

k
+
1


>
1
)






1
 
 
(

α
i


C

k
+
1


<
1
)










(57)






C

k
+
1


=


T
r
[

v

0
(
k
+
1
)


−

R

k
+
1


−

H

k
+
1



Q
k


H

k
+
1

T

]




∑

i
=
1

n



α
i

[

Φ

k
+
1



P

k
+
1



Φ

k
+
1

T


H

k
+
1

T


H

k
+
1


]








(58)






v

0
(
k
+
1
)


=

{







Z
˜

1



Z
˜

1
T

 
 
 
(
k
=
0
)








ρ

v

0
(
k
)


+


Z
˜


k
+
1



Z

k
+
1

T



1
+
ρ


(
k
≥
1
,
0
≤
ρ
<
1
)










(59)


where


α
i


 is the experience coefficient. When the status of the underwater vehicle changes rapidly, the error estimation



Z
˜


k
+
1




Z
˜


k
+
1

T


 can lead to an increment in the error variance


v

0
(
k
+
1
)



, and the weighted coefficient



λ


K
+
1



 will be larger. The ability of the filter to adapt will be strengthened when facing rapid changes in status. 4. Simulation Results and AnalysisBased on the filtering algorithm and the SINS/DVL integrated navigation system algorithm we described in the previous section, we verify the feasibility of and validate our proposed method in the Matlab environment, and also compare our proposed method with other related methods. 4.1. Simulation Setup 4.1.1. Motion Model and Simulation DesignIn order to verify the accuracy and stability of the filtering process, we established a motion model in which the state of motion changed with time. We assumed that the AUV’s travel time was 2000 s. First, the AUV traveled in a straight line with a north velocity of 2.57 m/s and an east velocity of 0.27 m/s for 1000 s. Then, a heading rate of change of AUV to the east was used for steering, and the course change time was 25 s. Then, the speed was maintained after steering from 1025 s to 1600 s. A heading rate of change of 3°/s to the north was used for turning at the time of 1600 s, and the course change time was 25 s. Finally, the AUV continued in a straightforward direction after turning. From 1000 s to 2000 s, the drive speed was 5 (2.57 m/s). The process of motion is shown in Figure 3 and Figure 4.Based on the model of the target’s motion, we evaluated the positioning accuracy and stability of our proposed method, especially when the velocity changes. 4.1.2. Evaluation MetricWe evaluated the performance of our proposed method in terms of positioning accuracy and efficiency. We also considered the stability of the positioning method when the system state changes dynamically. For positioning accuracy, we considered the eastward distance error, as the north distance error changed little during the AUV’s motion. For the positioning efficiency, we assessed the processing time of the positioning method. 4.1.3. Reference Positioning MethodsWe compared our proposed method with related positioning methods, including the classical Kalman filter, the strong tracking filter, the Sage–Husa adaptive Kalman filter, and the improved adaptive filter. (1) Classical Kalman FilterIn a complex underwater environment, the positioning accuracy and stability of this filter is very low. In the SINS/DVL integrated system, due to the instability of the components of the system itself and the uncertainties in the external environment, it is difficult to bring accurate statistical characteristics of noise to the system. With the conventional filters, stability and convergence are not guaranteed.(2) Strong Tracking FilterThis filter sacrifices positioning accuracy to ensure the reliable convergence of the filter. In strong tracking filtering, the pre-covariance matrix of the state estimation error is multiplied by a weighted coefficient to maintain the ability to track abrupt changes in the system state.(3) Improved Adaptive FilterTo improve the stability, minimize the error, and reduce the divergence of positioning error in dynamic filtering, the Sage–Husa adaptive filter adds statistical characteristics of noise to the observation data when estimating the system state at the next moment. The adaptive algorithm adds a calculation of the system’s statistical characteristics, which greatly increases the number of calculations and cannot guarantee the stability and convergence of a higher-order system. The adaptive Sage–Husa adaptive algorithm and the strong tracking Kalman filter have their own advantages and disadvantages. The former has high precision but a large computational burden, so it cannot guarantee real-time tracking and stability. The latter has a simple structure, high reliability, and a strong adaptive ability, but its filtering accuracy is reduced. When integrated, they give full effect to their advantages and constitute an improved Kalman filtering algorithm that not only suppresses the divergence of positioning error during filtering but also ensures the accuracy and efficiency of the filter. This method uses a convergence criterion to make a judgment about the divergence trend of the filter. If the filter does not diverge, the Sage–Husa adaptive algorithm is adopted. The strong tracking Kalman filtering algorithm is adopted when a divergence trend exists. 4.2. Positioning Accuracy and Stability EvaluationWe evaluated the positioning accuracy of the proposed method under the model of the AUV’s motion, and compared it with that of other related methods. We also considered the stability of the positioning system. Figure 5 shows the positioning error of these methods. Table 1 illustrates the statistical positioning error parameter of the different methods. 4.2.1. Positioning Accuracy AnalysisIt can be seen from Figure 5 and Table 1 that the positioning accuracy of the proposed filtering gain compensation-based adaptive filter is significantly better than that of the other related methods. More specifically, the positioning error of our proposed method is the lowest among these methods. From the viewpoint of the minimum, maximum, and peak–peak error value, the lower the peak–peak value is, the higher the positioning accuracy is. So, we can see that the filtering gain compensation-based filter performs better than the other methods. From the viewpoint of the mean positioning error, when compared to the classical, strong tracking, and improved adaptive filtering methods, the proposed method improves the positioning accuracy by 98.70%, 59.06%, and 106.46%, respectively. This result is mainly due to the Kalman filter not being able to track the system in real-time due to the sudden changes in the state of motion of the AUV at 1000 s and 1600 s, so the positioning error in the classical Kalman filter is very large. The filtering gain compensation-based filter takes advantage of the combination of the filtering gain compensation adaptive filter and the filtering gain compensation strong tracking Kalman filter. It can track the rapid changes in the AUV’s state of motion, and can better correct system errors and improve the positioning accuracy, so it has the lowest positioning error, and can also guarantee the system’s stability.(1) Comparison with Classical Kalman FilteringIt can be seen from Figure 5 and Table 1 that the positioning accuracy of the filtering gain compensation-based filter is significantly better than that of the classical Kalman filter. The peak–peak positioning error of the proposed method is 0.2476 m. The corresponding error of the classical Kalman filter is 6.9751 m. The proposed method improves the positioning accuracy by 98.70%. This is due mainly to the classical Kalman filter being unable to track the sudden changes in the AUV’s state of motion at 1000 s and 1600 s. The filtering gain compensation-based filtering method can better correct system errors and enhances the positioning accuracy.(2) Comparison with Strong Tracking Filtering and Improved Adaptive FilteringFrom Figure 5 and Table 1, it can be seen that the positioning error of the filtering gain compensation-based filter is much lower than that of the strong tracking filter and the improved adaptive filter. More specifically, compared with the two filtering methods, the proposed method improves the positioning accuracy by 59.06%, and 106.46%, respectively. Although the two methods are able to track the sudden changes in the AUV’s state of motion at 1000 s and 1600 s, the positioning error fluctuates significantly. The proposed method utilizes the error statistics of the position parameter and filtering gain compensation-based adaptive filtering to track the sudden changes in the AUV’s state of motion. So, it produces the highest positioning accuracy. 4.2.2. Positioning Stability AnalysisWe evaluated the positioning stability in terms of the fluctuation in positioning error when the AUV’s motion status changed rapidly. It can be seen from Figure 5 and Table 1 that, when the AUV’s state of motion suddenly changes at 1000 s and 1600 s, the fluctuation in positioning error of the classical Kalman filter is the largest. It will take a long time to converge. The strong tracking filter, the improved adaptive filter, and the filtering gain compensation-based adaptive filter are able to significantly improve the stability. In particular, the fluctuation in the positioning error of our proposed method is very small (around 0). Regarding the peak–peak positioning error value, it is 6.9751 m, 1.3195 m, 0.3509 m, and 0.2476 m for the classical filter, the strong tracking filter, the improved adaptive filter, and the filtering gain compensation-based adaptive filter, respectively. Compared to these methods, our proposed method improves the peak–peak positioning error value by 96.45%, 81.24%, and 29.44%, respectively. So, the stability of our proposed method is the highest. It can be seen that the improved adaptive filtering algorithm based on filtering gain compensation that was designed in this study can better cope with the sudden changes in the AUV’s state of motion and improve the reliability of the system. This is because the filtering gain compensation algorithm compensates for the system error variance matrix when the AUV’s motion state experiences abrupt changes, which helps it to track the state of the system and improve the system’s positioning accuracy and reliability. 4.3. Positioning Efficiency EvaluationWe evaluated the positioning efficiency in terms of the positioning simulation time under the aforementioned model of the AUV’s motion. Table 2 lists the positioning simulation time of these methods.From Table 2, it can be seen that the proposed filtering gain compensation-based adaptive filter has the largest positioning simulation time among these methods, while that of the classical Kalman filter is the smallest. This is because the filtering gain compensation-based algorithm itself analyzes the state of motion of the system and compensates for the error caused by the sudden change in the AUV’s state of motion, so the positioning simulation time is greater than that of the other methods. So, the efficiency of the proposed method is lower than that of the other methods. However, it should be pointed out that the loss of positioning efficiency remains within an acceptable range relative to the improvement in accuracy and stability.Based on the above simulation analysis, we can conclude that the filtering effect of the gain compensation-based adaptive filter is obviously better than that of the classical Kalman algorithm and the strong tracking filtering algorithm in the integrated navigation process. In the case of a complex state of motion, the filtering effect is better than that of the improved adaptive filtering algorithm. 5. DiscussionTo improve the positioning accuracy and stability of AUVs, we present a filtering gain compensation-based adaptive filter for the SINS/DVL integrated positioning system. In contrast to previous studies, we utilized indirect filtering and an integrated positioning error model to model the positioning parameters of the system. We also considered the error characteristics of the navigation parameters, and used the filtering gain compensation-based adaptive filter to filter the positioning parameters of the SINS/DVL integrated system in order to obtain an accurate and stable positioning result. However, we found that its calculation complexity is higher than that of other filtering methods. In our future work, we will perform further research on the SINS/DVL integrated positioning system based on the filtering gain compensation-based adaptive filter, cooperate with the Deep Sea Center, and evaluate our presented method in a real underwater environment. 6. ConclusionsThe SINS/DVL integrated navigation system’s positioning process has insufficient positioning accuracy due to the long distances and the complex task environment. In this paper, we presented an adaptive filtering method based on filtering gain compensation for the SINS/DVL integrated navigation positioning system. In this method, the indirect filtering method was selected, and an integrated navigation error model was utilized to model the navigation parameters of the system. Then, based on the error characteristics of the navigation parameters, the improved adaptive filtering method for filtering gain compensation proposed in this paper was adapted to filter the navigation parameters of the system and obtain information on errors in the navigation parameters. Finally, the navigation parameters of the system were solved by combining the information on errors in the navigation parameters to obtain high-precision navigation results and realize the accurate positioning of underwater objects.Our simulation results demonstrate that, compared with the classical Kalman filter and the strong tracking Kalman filter, the filtering method proposed in this paper can effectively improve the positioning error and has higher positioning accuracy. This is due mainly to the impact of the abrupt changes in speed and course on the positioning accuracy. The proposed filtering gain compensation-based algorithm can quickly track the system state in real-time and reduce the speed of error accumulation, so as to ensure the high-precision positioning of the AUV under long distance conditions and meet the positioning accuracy requirements in a complex task environment.
