 1. IntroductionElectrochemical energy storage cells with lithium have been gradually entering in all our society’s power levels. Different types of commercially available Li-ion cells do exist presently with many more being under research [1,2]. Lithium-ion battery (Li-ion) cell’s nominal performance in terms of volumetric (size) and gravimetric (weight) energies, specific power, operating voltage and charge/discharge loading capabilities depends on the formation of anode and cathode active material, electrolyte, separator, current collectors and cell’s shape [3]. This composition characterizes electrically, thermally and mechanically the Li-ion cell with its nominal values at a certain temperature, also known as the beginning of life (BoL) state of the cell.It is crucial to characterize, model and assess the cell’s behavior at the BoL (off-line) and to adapt the identified parameters at various conditions and states (online) to enhance performance during operation. This is achieved by accurately obtaining the main parameters of the cells i.e., the impedance, capacity and open circuit voltage, and by deriving a suitable model for the microprocessors of the battery management system (BMS) that are designed to monitor and perform an optimal operation within a predefined safe-operation-area (SoA) and power limits [4]. The modeling of the Li-ions is achieved with one of the following methods [5,6]:Generic-based or data-based empirical models,Electrochemical impedance spectroscopy (EIS)-based models,Static and dynamic equivalent electrical circuit models (ECM) andElectrochemical and physics-based models.The generic models are usually based on the Shepards equation [7], they are mathematical representations of the voltage usually with a low physical meaning. Hence they can be preferred for simple representation of the Li-ion batteries although they can be challenging for online parameter adaptation and state estimation.The frequency domain models analyze the impedance of the cells in a wide frequency range with superimposed AC signal carried by a DC (charge or discharge) to investigate the overall working principle of the Li-ions. The linearity and time invariance of the system are achieved with the low AC power amplitude ranges of the experiment (mV or mA) which leaves aside however the current rate dependency on the cells [8,9]. Dealing with this, the non-linear Butler–Volmer equation (BVE) along with the Arrhenius relationship can give the charge-transferring temperature and current dependence of the cells [10], raising however questions on the accuracy and computation effort of solving on-board such non-linearities.An electrochemical model has the highest fidelity, but it is a computational demanding representation of the working principles of the cells. This is accompanied with a huge number of parameters that must be identified and adapted to circumstances, which makes them so far inefficient for on-board applications.A good compromise between physical representation of the cells and the fast modeling response is obtained with ECMs. They are further subdivided into static and dynamic modeling approaches. The former models represent the cells with simple polynomial equations suitable for constant charge/discharge representation. The latter can give a dynamic model that can be addressed to real-life loading cycling profiles. For either case, the ECMs are composed of lumped equivalent electrical elements that represent the working principles of battery to a certain degree. In one hand simple static models can be generated without any experimental characterization and can model accurate constant power profiles. Alternatively, dynamic ECMs require a series of electrical testing from which the lumped parameters are derived by applying parameter identification techniques. In most studies however, focus is laid on comparisons among the different modeling ECM approaches, nevertheless, to the best of our knowledge, the parametrization techniques are rarely compared under the framework of a certain chemistry and model, similarly stated by Lai et al. [11], in which however various ECMs are compared for several heuristic algorithms.Furthermore, the low computational power of the BMS renders necessary not only to reduce the modeling parameters to the minimum necessity, but also to depict the electrochemical processes as accurately as possible. Regarding this, the second-order ECM, also known as the dual-polarization ECM is selected in this work to characterize the Li-ion cells. Three parametrization methods are investigated and compared for two different anode-based cells and two types of validation profiles are used to assess the identification results.The generated ECMs in this work are compared for their robustness, computational effort and accuracy at an off-line modeling approach. Also, the power capability is estimated under charge and discharge of the cells, while impedance comparison among the proposed methods and EIS is taking place as a merit of evaluation on the physical accuracy of estimated parameters from the identification techniques.This paper’s overall motivation is seen in three parts:An experimental characterization and electrical modeling of the Li-ions with three different parameter identification methods,A comprehensive comparison among the parameter identification methods from previous studies,Analyses on the impedance behavior of the cells in time and frequency domain and estimation on the power capabilities of the cells.The paper is organized as follows: the experimental setup as well as discussion of the Li-ions main characteristics and the experimental process are presented in Section 2, the proposed model development is analyzed in Section 3 and a comprehensive comparison on different parameter identification methods is performed in Section 4. Impedance results, comparisons over the methods and discussions are taking place in Section 5, whereas Section 6 concludes the paper. 2. Experimental Setup 2.1. Test Bench DescriptionTwo commercial prismatic Li-ion cells are tested, suitable for either high-power or high-energy applications, one LTO and an NMC. Their shape and main characteristics are illustrated and compared in Figure 1, while Table 1 gathers the main electro-mechanical properties of the Li-ion cells.Figure 2 illustrates the test setup. Steel connectors are attached to the aluminum tabs with a spot-welding technique. Laser welding for aluminum-to-aluminum interconnection is also being investigated to compare the contact resistance and tensile force capabilities [12]. Cells are placed inside a temperature chamber to preserve

25


∘


C and they are connected to the PEC ACT0550 tester, capable of up to DC 5 V measurements with a

±
0.005
%

 accuracy.It consists of equipment commonly found in a battery dedicated laboratory: Battery tester can charge/discharge and monitor cell’s voltage, current and temperature, one K-type thermocouple for the surface of the cell and climate chamber to control the environmental temperature. Raw data in terms of voltage, current, power, energy, step, cycle and temperature. 2.2. Experimental ProcessThe methodology followed in this work to electrically characterize the Li-ion cells is summarized in the flow chart presented in Figure 3. In this section, the main characteristics of the cells and the methods employed for experimentally extracting the impedance are analyzed. A brief description on the several impedance measurement methods can be found also here [14]. 2.2.1. Open Circuit Voltage TestOCV test is performed to extract the voltage of the cells at no-loading and equilibrium state (

V

O
C


). With a current rate of C/5 the batteries are fully charged and 5% discharging steps are followed until

V

c
u
t
−
o
f
f


 to evaluate the

V

O
C


 after 3 h resting period, which takes place at each state of charge (SoC) step. Reverse procedure is followed for the charge OCV test. Regarding the relaxation of the cell voltage, it occurs due to the rapid discharge of the double layer capacitance as the ions move away from the electrode surface (at a range of msec) and the slower time-constant diffusions of the ion’s redistribution within the liquid (electrolyte), until the concentration reaches equilibrium state and form the re-arrangement of atoms within the solid materials (electrodes). To incorporate for the slow diffusion processes of the cells, it is recorded that after 240 min the double layer capacitance and the diffusion processes in solid and liquid do not significantly change the impedance and the voltage error lays between measurement noise regardless cell type and chemistry, whereas after approximately 900 min of relaxation time, equilibrium is reached [15,16]. Figure 4 shows the measured

V

O
C


 during charge and discharge of the cells.OCV curves are fitted with an nth order polynomial as


V

O
C


=
f

(
S
o
C
)

=

α

n

t
h



S
o

C

n

t
h



+
⋯
+

α
1

S
o
C
+

a
0


 or adopted with look-up tables. It is observed that

V

O
C


 measured during charge is slightly higher for both chemistries. This, SoC dependent phenomenon, can arise from the internal resistance increase in the electrode at the edges of the charge/discharge and it is referred in the literature as hysteresis [17]. It is observed that the hysteresis behavior changes with the chemistry; however, it is more significant for the higher non-linear regions between 0–20% and 80–100% of the SoC. Accordingly, for the Li-ion that pose such relative low hysteresis levels a direct modeling approach is adopted [18]. Usually, the hysteresis branch on the modeling is proposed for chemistries that show a greater effect, such as in LFP chemistry, in the ranges of 50 mV and above. Regarding this, authors in [19] suggest the one-RC model with hysteresis that comes without an extra increase in complexity, as a better trade-off of such chemistry modeling approach.Nevertheless, a brief comparison on the cells OCV shows a faster voltage increase of the NMC cell (

Δ
O
C
V
/
Δ
S
o
C

) at the slow dynamic area (20%

<
S
o
C
<

 80%) which, in addition to inadequate relaxation time, can affect the OCV-based SoC estimation methods [20]. At such cases, a structured ECM that embodies the Li-ion’s hysteresis behavior is a requirement. 2.2.2. Voltage Response to Current TestThe voltage response to several current rates is investigated at the same temperature as the OCV test. A CCCV charge profile is applied to the cells to reach the 100% SoC, and it is followed by discharge pulses with C/5 at a 5% SoC step, until the voltage cut-off limit is reached. Right after each 5% SoC drop, five (for NMC) or 7 (for LTO) current pulses at various rates, with a

Δ
t
=
10

 s duration are performed before the cells are rest for a relaxation time, similar to OCV test. The current pulses with different amplitudes are applied at both charge and discharge directions with one-minute rest in-between. 2.2.3. Impedance Response to Frequency TestLi-ion characterization technique through current pulse (HPPC) results in discrete-time-dependent impedance measurements. However, realization of electrochemical properties and phenomena such as the impedance growth during intercalation and de-intercalation of lithium charge and discharge process cannot be investigated with this method. On the other side, EIS is a common method for this purpose where the key power limiting factors such as electrolyte conductivity, solid-electrolyte interface (SEI) growth and the charge-transfer resistance behaviors can be analyzed with an small AC excitation signal [21]. It is a method extensively used over the years in battery characterization [22] and battery ageing [23,24]. Here, a potentiostatic EIS is performed on both cells with BioLogic MPG-205 equipment and the impedance spectra is generated by imposing an AC voltage impulse from 10 kHz to 5 mHz frequency range and at controlled ambient temperature of

25


∘


C and 4.3 mV amplitude. Figure 5 shows the plotted Nyquist curve for the Li-ion cells at five different SoCs (0%, 20%, 50%, 80% and 100%) to illustrate the evolution of imaginary against the real impedance.Ohmic resistance is obtained at the intersection of the real and the imaginary axis. As with [25] and depending on the chemical composition of the cells, the curve is shifted here towards right and upwards with the decreasing SoC indicating the increment on the Ohmic resistance as the SoC is decreased. From the generation of the EIS-based models, the DC offset that creates the charge-transfer impedance to current dependency cannot be incorporated, which makes the ECM inefficient for dynamic loading profiles. This challenge is addressed, and will be further analyzed in following section, with the Butler-Volmer equation (BVE). 2.2.4. Capacity TestDuring charge and discharge at different current rates, the capacities of Li-ion cells differentiate from the nominal values in a reverse proportional rate to the current as described by Peukert’s law [26], whereas they are also follow an Arrhenius temperature dependency [27]. This study focuses on

25


∘


C for which the capacities values of both cells during charge and discharge, as well as approximation of the Coulombic efficiency

η
=
A
h
D
i
s
c
h
a
r
g
e
/
A
h
C
h
a
r
g
e

 are calculated. In the case of inadequate relaxation period after the CCCV charge an increased discharged capacity can be measured and
η
 is set to 1. Also, a slightly higher capacity of the cells can be observed while increasing the C-rates at a certain temperature (usually low) due to the proportional enhancement of the charge-transfer kinetics occurring from the increased (self-heating) temperature. To cope with this, cells are placed in a climate chamber that actively monitor and maintain temperature as close as possible to the predefined

25


∘


C. Capacities of the cells are shown in Table 2. 3. Model Development 3.1. In Discrete-Time DomainThe model that is employed in this work is the dual-polarization ECM which refers to the second-order RC circuit as shown in Figure 6. It represents the time-dependent polarization processes taking place during charge/discharge, the relaxation effect and the equilibrium open circuit

V

O
C


 in the battery cells. At a current passage, the terminal voltage

V

b
a
t
t


 diverges from the

V

O
C


 due to material resistivity, electrochemical reactions and diffusion processes [28].The ECM considers the load demand, the initial SoC of the cells and the temperature as inputs in order to estimate the terminal voltage and the states of the Li-ion cells which are described by Equation (1):






V

b
a
t
t





=

V

o
c


−

V
1

−

V
2

−

R
0



I

b
a
t
t









V
1

˙




=
−

1


R
1



C
1





V
1

+

1

C
1




I

b
a
t
t









V
2

˙




=
−

1


R
2



C
2





V
2

+

1

C
2




I

b
a
t
t









(1)


where

V

o
c


 is the OCV obtained from the experiment,

R
0

 is Ohmic resistance,

R
1

 and

R
2

 represent the activation (electrochemical) and the concentration polarization respectively (m
Ω
) with the capacitances (

C
1

 and

C
2

 in

k
F

) as to relate the voltage drops across them (

V
1

 and

V
2

 in mV) with the two different time-constant. The former, activation polarization

V
1

 is associated with the charge-transfer and the SEI layer build up resistance. The latter accounts a concentration gradient build-up taking place at current flow or during vice-versa during relaxation, represented by

V
2

.

I

b
a
t
t


 is the current flow through the battery cells (Amps) with a sampling period of


T

s
a
m
p
l
e


=
0.01

 s and it is considered negative for charge.Since the impedance is dependent on the SoC, a function for this purpose is integrated in the DP ECM. Generally, the SoC of cells can be estimated with OCV(SoC)-based method [29,30], with power electronics such as online EIS measurement [31,32], model-based-estimation and machine learning algorithms, and Ah(Coulomb)-counting, as it thoughtfully discussed in previous studies [33,34,35,36]. Challenges with certain chemistries can rise, as for LFP’s low

Δ
O
C
V
/
Δ
S
o
C

 at the slow dynamic area and its hysteresis effect makes OCV (SoC)-based methods not optimal [37,38], whereas EIS-based measurements lack accuracy through ageing and the estimations are highly influenced from chemistry and experimental conditions [39]. Also, due to overload on computational complexity and memory storage or lack of accuracy, most implementation are to not suitable for on-board applications. However, certain model-based methods and the Ah-counting are proven more relevant for this purpose.More in precise, the model-based estimation with adaptive Kalman and particle filters or observers and fuzzy logic [40,41,42] or machine learning algorithms such as artificial neural networks (ANN) [43,44] and support vector machines (SVM) [45] are typically used for on-board implementation, taking into account their increased computational and memory requirements. On the other hand, the SoC estimation from Ah-counting [46] depends on the accuracy (sampling precision and frequency) of the current sensors and the initialization of the cell’s capacity. It usually gives accurate results, which also relies on the initial and re-calibrated (to avoid error accumulation) SoC after dynamic load profiles [47]. This low-cost estimation method is used in this work as well, according to Equation (2).




S
o
C

(
t
)

=
S
o

C
0

−

η

C
n



∫

i
(
t
)


d
t




(2)


where

S
o

C
0


 is the initial state of charge,
η
 is the Coulombic efficiency of the cell at the certain C-rates,

i
(
t
)

 is the instantaneous current through the cell and

C
n

 is the initial capacity (

A
s
e
c
·
T
s

 = discrete sampling period) as a function of temperature and current rate.Besides the ECM parameters, the total cell’s resistance incorporates both the Ohmic and polarizations and is considered to be the DC resistance of the Li-ion that can be extracted according to Ohm’s law from the measured voltage drop at a current pulse as in Equation (3):







R

D
C
,
p
u
l
s
e




|


Δ
t






=


Δ

V

p
u
l
s
e




I

p
u
l
s
e
,
m
a
x









Δ

V

p
u
l
s
e




|


Δ
t






=

V

m
a
x
,
p
u
l
s
e


−

V

O
C
,
p
u
l
s
e









(3)


where

Δ

V

p
u
l
s
e



 is the overpotential between the terminal voltage

V

m
a
x
,
p
u
l
s
e


 and the

V

O
C
,
p
u
l
s
e


 of the current pulse. This resistance is a modeling assumption that represents the overall impedance of the cells during a current excitation which is practical for on-board estimation of the available source or sink power capability of the cells

P

p
u
l
s
e


, and also the limitation on rate of current

I

p
u
l
s
e
,
m
a
x


 that can be drawn or fed on either charge or discharge direction over a short period of

Δ
t

. They can be estimated according to Equation (4) [48]:




P

p
u
l
s
e




|


Δ
t


=


Δ

V

p
u
l
s
e


·

V

m
a
x
,
p
u
l
s
e




R

D
C
,
p
u
l
s
e







(4)

The power capability is inverse dependent on the

R

D
C


 of the battery cells and follows the overpotential

Δ

V

p
u
l
s
e



 build-up during the pulse. As a result, it is highly influenced from the C-rates, the operating temperature and the current pulse length period, as well as the SoC of the cells throughout ageing and their chemistry [49]. Consequently,

P

p
u
l
s
e


 is assessed here for three C-rates (0.33 C, 1 C and 2 C-NMC or 3 C-LTO) and at three SoCs (20%, 50% and 80%), for three different pulse times

Δ
t

 = 2 s, 10 s and 20 s at

25


∘


C and BoL. The generated power losses at the respective states can be simply calculated by


P

l
o
s
s


=

I

p
u
l
s
e

2


R

D
C
,
p
u
l
s
e



 [in the range of a few Watts]. 3.2. In Frequency DomainThe impedance analysis in time domain is a combined effect of resistance and overpotential at a current excitation. To get a clear view on the individual generated resistances and losses, the proposed equivalent circuit illustrated in Figure 7 is selected. EIS can effectively separate the losses with different time constants (Ohmic, solid-electrolyte interface (SEI), charge-transfer, diffusion), evolving at frequencies between several kHz to a few mHz range [50]. Depending on the chemistry and state of health, the first semi-circle is related to the SEI layer of the anode. Nevertheless, in this work a single semi-circle associated with the double layer capacity and charge-transfer resistance on the electrodes is observed and modeled accordingly, assuming the impact of SEI formation negligible and with similar time-constant.The key elements in this modified Randles circuit model are

L
0

 which represents the cabling and connection inductance and

R
0

 the Ohmic resistance of the battery cell generated from the material composition conductivity. They are observed in the highest frequency ranges of the EIS spectrum, characterized by the materials and the surface geometry, where in our case deviate form

10
4

 to

10
2

 Hz. Also, the parallel branch

R
1

 with the constant phase element (CPE)

Q
1

 which combines the kinetics impedance related to the electrochemical charge-transfer and double layer, it takes place in the range of

10
3

 to

10
0

 Hz [51,52]. Lastly, a second CPE

Q
2

 related to diffusion process and the mass transportation is modeled which is considered at low frequencies and time-constant in the range of several seconds to minutes [53,54]. These parameters are obtained from EC-Lab®fitting software based on Equation (5) [55]





Z

E
I
S


=
j
ω

L
0

+

R
0

+

1


R

1


−
1


+


(
j
ω
)


ξ
1



Q
1



+

1



(
j
ω
)


ξ
2



Q
2







(5)


where

Z

E
I
S


 is the impedance of the ECM and

1



(
j
ω
)


ξ

1
,
2




Q

1
,
2




 is the impedance of the CPE elements with a depression factor

0
≤

ξ
i

≤
1

 on the Nyquist plot (0 = resistor, 1 = capacitor with ideal semi-circle of R//C).The proposed EIS equivalent model gives a good fit with experimental data which can be seen in Figure 8 for LTO and NMC cell, respectively. According to previous studies various modeling representations of Li-ions in frequency domain are proposed by adding either extra parallel branches of R//CPE elements [54,56] or Warburg element [57] in order to approximate more accurate the electrochemical reactions taking place in the whole frequency spectra, with a trade-off between modeling simplicity and accuracy [22]. In this work, as also explained in next section, the proposed model topology of Figure 7 is selected, as it shows good agreement to the experimental data with the minimum required lumped elements. The values associated with the EIS model fittings are shown in Table 3 for all the SoC steps. The corresponding modeling error (


Z

E
I
S


−

Z

m
o
d
e
l



) stays below 1.52 ×

10

−
5


 for most cases, generated from the EC-Lab®fitting software.The simulated and experimental data comparison was done at 50% SoC and at room temperature. The impedance parameters of

R
0

 can be extracted from the fitted curves and

R
1

 can be calculated from the plotted curves semi-circle to represent charge-transfer resistance between electrolyte and active materials [58]. 3.2.1. Ohmic ResistanceOhmic resistance varies during charge/discharge due to the materials composition and their conductivity properties. It is strongly dependent on the ionic conductivity of the electrolyte [59,60], the electric resistance of the electrode, tabs and current collectors and their interfacial resistance [61]. It can change over temperature, ageing and SoC fluctuations, while it is mostly independent on the current’s amplitude and the relaxation time. It is observed that impedance obtained from EIS at the


f

s
a
m
p
l
e


=
100

 Hz deviates from EIS

R
0

 (at the intersection of the curve with zero imaginary axis) at less than 0.06 m
Ω
. More in precise, the intersection of real to imaginary part takes place accordingly at frequencies

f

i
n
t
e
r
s
e
c
t
i
o
n


 = 128 Hz and 172 Hz for LTO and NMC. The deviation has a positive correlation to the

Δ
f
=

f

i
n
t
e
r
s
e
c
t
i
o
n


−

f

s
a
m
p
l
e



 whereas here, either point is considered to have a minor effect on the determination of the

R
0

, as also discussed in the voltage to current response section. Hence, both Ohmic resistances obtained are used as a benchmark to compare the Ohmic resistance acquired from time-domain modeling at the same sampling frequency. It should be noted here that determining pure Ohmic resistance requires a very fast sampling capacity. In our case, since it is close to the sampling frequency the error of the HPPC and the EIS can be low, but other chemistries that the Ohmic is generated at the range of 0.5 kHz (such as LFP in [23]), its measurement from HPPC is impractical. 3.2.2. Charge-Transfer and Total ResistanceAn electric field applied to the current collectors results in a current density described by the BVE, as a function of the electrochemical charge-transfer overvoltage during redox reactions at the electrodes. On the contrary to the Ohmic resistance, the Faradaic branch elements


R
1

/
/

Q
1


 are highly dependent on current density but also at SoC, temperature and ageing. During the first instances at a charge/discharge pulse for the high frequencies, the double layer capacitor impedance acts as a short circuit and it is quickly charged. Consequently, at lower frequencies it effectively behaves as an open circuit and the whole current is flowing through the charge-transfer reaction. A superimposed DC current EIS technique can be used to fit and quantify the charge-transfer

R
1

 resistance [62]. Alternatively, the total resistance can be used, obtained either at the end of the EIS frequency spectrum 5 mHz, or from the pulse test if both the linear Ohmic resistance overvoltage and the logarithmic electrochemical are considered. The modified BVE can be used as in Equation (6), only if the mass transport is neglected at cases with lower than 5 s pulse currents [3,63,64]:







V

o
c


−

V

b
a
t
t






=

R
0


I

b
a
t
t


+

V
1

+

V
2


⇒







V

o
c


−

V

b
a
t
t






=
Δ

V

D
C








I
=

I
0

·

{
exp
(








α

a
n
o
d
i
c


n
F


R
T


Δ

V

D
C



)
−
exp

(


−

α

c
a
t
h
o
d
i
c


n
F


R
T


Δ

V

D
C


)

}








(6)


where

n
,
F
,
R
,
T

 are constants: n is the number of electrons involved in the reaction per molecule of the active material, F the Faraday constant, R the general gas constant, T the absolute temperature in Kelvin [65]. By performing current pulses technique and using a simple NLS fitting of Equation (6) to the results, missing information on the

α
,

I
0


 constants can be found and the


R

D
C


=
f

(
I
)


 be estimated. A thorough investigation on the non-linearities of the symmetry factors
α
 and the exchange current density

I
0

 can be found in [64] for LTO cells, signifying their evolution over various states and temperatures. Another approach by Zhu et al. in [66], approximates both the non-linear dependency on current and temperature of the modeled resistances obtained from a 30 s HPPC test, where they propose an electro-thermal model to predict power at low temperatures.If

V
1

 is used instead of the DC overpotential, the pulse technique is not required and the charge-transfer resistance


R
1

=
f

(
I
)


 dependency on the current can be estimated by making certain simplifications on the BVE, as analytically discussed in [65]. In this regards, assumptions are made on the symmetry factor for both redox reaction rates depending the desired complexity level on the current dependency approximation, i.e., either symmetric kinetics


α

a
n
o
d
i
c


=

α

c
a
t
h
o
d
i
c


=
0.5
,


α

a
n
o
d
i
c


+

α

c
a
t
h
o
d
i
c


=
1

 [67] are assumed i.e., the reaction processes are at the same speed, or the influence of voltage drop on small currents is negligible according to Tafel equation and the cathodic part of the BVE could then be neglected [68]. 3.2.3. Diffusion ResistanceAt frequencies between 5 Hz–5 mHz for the Li-ions under testing here, the diffusion processes caused by the ion concentration at the location of the charge-transfer creates a diffusion overvoltage which is generally described by Fick’s law [69], and is modeled here with the CPE

Q
2

. The time-constant that describe the diffusion processes depend on the electrode geometry, temperature and electrolyte ion concentration [50].Diffusion overvoltage is becoming more pronounced for high rated excitation currents with periods more than

Δ
t
=
5

 s. It is the main reason for decreased capacity of the Li-ions over a full discharge cycle at increased current rates and the proportionally increased Joule losses. This is an effect of the ions that cannot be diffused fast enough in the place of charge-transfer and create a high ion concentration c at the electrode-electrolyte interfaces which creates high overpotential

V
2

 with the aforementioned results. Equation (7) describes this correlation where

c
0

 is the equilibrium concentration [28]





V
2

=


R
·
T


n
·
F


·
l
n

(

c

c
0


)





(7)

The working principle of the EIS brings challenges in the identification of the slow time-constant diffusion processes within liquid and solid [70], while a Warburg element may represent one out of three possible diffusion processes [50]. Other empirical approaches have proposed to model accurately and temperature depending the diffusion resistance with adding a proportional to the square root of time resistive element, dependent as well on the open circuit voltage

V

O
C


, instead of CPEs [71]. In either case, excitation signals are applied to the Li-ion for several mHz to avoid close to DC excitations and prevent changes over the SoC or exacerbated ageing effects. Addressing to this, authors in [72], propose a method to extract the electrolyte and solid-state diffusion overpotential from the HPPC pulse test for much lower frequencies. They performed it by suppling a 6min pulse and a 3h open load resting period, subtracting the high-frequency contribution obtained from the EIS, to the relaxation overvoltage after the current is switched off, and subsequently estimate the diffusion equivalent resistance after the applied potential is released. 4. Review of the Most Frequently Used Identification MethodsThe identification methods are divided in the literature into three main categories, according to the characterization processes of cells that is followed. First, EIS group that characterizes the equivalent impedance in the frequency domain. Second, impedance characterization generated from the electrical standardized test and third, electrochemical models which can be the most accurate but least computationally efficient for on-board applications [73]. in this work the third modeling approach is not investigated, where the parameter identification methods for the rest are addressed by one of the following categories:Analytical equations,Least-square-based methods,Heuristic optimization algorithms,Impedance spectroscopy methods andKalman or adaptive filters and observer-based methods.These methods are used for parameter identification and can be applied for on-board model-based state estimation and parameter tracking. In Figure 9 the parameter identification approaches are summarized.The empirical model-based methods that are obtained from experimental observations and mathematical representations are discussed. Also, Table 4 gathers several references with the aforementioned parameter identification methods. 4.1. Parameter Extraction with Analytical EquationsModeling a Li-ion in the time domain (TD) uses the differential equations that describe the ECM as in Equation (1). It is a straightforward mathematical approach that identifies the resistances and the capacitances of the nth order ECM from the HPPC based on Equation (8).







R
n




=


Δ
V

|

j

k




I
k


(
1
−

e

−


t

|

j

k



τ
n




)



,


C
n

=


τ
n


R
n








τ
n




=


Δ
t

|

j

k



l
o
g

V
j

−
l
o
g

V
k





,

x
|


j

k

=

x
k

−

x
j








(8)


where

R
n

,

C
n

 and

τ
n

 are lumped parameters of the selected nth order ECM obtained from HPPC at the discrete pulse time of

Δ
t

|

j

k


.

R
0

 is calculated similarly to the DR resistance (Equation (3)) for the Ohmic region. Defining the starting and ending points

j
,
k

 of the respective Ohmic and polarizations areas is the main challenge. Waag et al. in [63] used —an application specific— linear approach of the voltage response at a 10 s current excitation to decouple the Ohmic and the electrochemical to the concentration polarization overpotential after a 5 s period. On the other side, it usually appears as an arbitrary process, sample/time-dependent and defined from observations on the voltage pulse behavior [74,75,76,77]. As a general rule, the concentration polarization voltage response reaches steady state at approximately four to five-time constants

Δ
t
=

5
R
C

 after switching off the current.In [75] the time-domain DP is analyzed based on the power profile of a heavy-duty underground mining load-haul-dump (LHD) loader with a 20 kW average power per cycle. A battery pack is constructed with seven 40 Ah NMC cells in series and the DP is parameterized with TD analytical equations. A mean absolute percentage error (MAPE) of less than is 0.2% is seen signifying the applicability of the method for heavy-duty modules as well.In Figure 10, the regions at the HPPC are chosen according to EIS, where Ohmic is considered on the


f

h
p
p
c


=
100

 Hz sampling frequency as previously discussed (

j
=
1
,
k
=
2

), the activation and concentration polarization regions are defined at the theoretically first sample of a


f

h
p
p
c


/
6

=

17

 Hz and a


f

h
p
p
c


/
1000

=

0.1

 Hz sampling frequencies respectively, with the corresponding sampling points at

j
=
2
,
6

 and

k
=
6
,
1000

 respectively. The 17 Hz value is as close as possible to the local minimum frequency

f

m
i
n


 of the semi-circle for both cells, which defines in the EIS impedance characterization, the time-constant

τ

=

1
/
2
π

f

m
i
n



 of the semi-circle. The latter value of

0.1

 Hz is the last point of the HPPC

10
s
e
c

 pulse, which fall inside the low-frequency diffusion area of the EIS. 4.2. Parameter Extraction with Least-Square MethodsThe second group of the parameter identification includes the least-square methods (LS) which are based on non-linear curve fitting of the experimental to the modeling data set by minimizing the sum of squared residuals. Several versions of LS methods are structured upon their methodology: the recursive least-square (RLS) with or without forgetting factor to adapt their actual changes over the lifetime, the weighted recursive least-square (WRLS) to weight recent data more than old, or the weighted recursive least-quadratic-squares (WRLQS) and others can be found in [68,78,79,80,81]. Recursive LS methods have shown fast-computing capability with high accuracy and low data storage requirements, capable of surpassing the computational limitations for a BMS integration.In this work, since the Ah-counting is proposed for SoC estimation and the cells are tested at the BoL aiming to assess the efficiency of various parameterization methods, the trust-region-reflective non-linear least-square algorithm is employed, which however is susceptible to divergence problems by getting trapped to local minima when the initial values are not precisely defined [82,83]. A straightforward calculation based on the discrete TD equations is performed to set the initial values of the R,C elements according to Equation (8). The rest values, are optimized by minimizing the objective function as Equation (9):




F

o
b
j


=

∑


t
i

=
1


Δ
t




(

V

b
a
t
t
,

t
i



−

V

b
a
t
t



′



(

t
i

)

)

2

,
i
∈

[
1
,
s
]





(9)


where

V

b
a
t
t
,

t
i



 is obtained from HPPC response and


V

b
a
t
t



′



(

t
i

)


 is the estimated value defined in Equation (1) for a total

s
=
1000

 samples. More details on the LS algorithm can be found in [84] and for the current flow through the polarization resistance in [85].In previous studies, NLS method is implemented to characterize the DP model impedance of a A123 14 Ah LFP battery cell and to obtain the SoC with a proposed EKF [86]. Various high current pulses are also implemented to assess the internal resistance’s behavior over a wide current range, giving a max voltage RMSE < 12 mV with dynamic stress test (DST) profile. Wang et al. in [87] perform another modeling comparison which reveals that the DP model characterized with NLS performs better for SoC estimation with a combined EKF-Ah method, compared to the Thevenin or PNGV ECMs. This model show a lower SoC estimation error validated with DST and constant current discharge profiles with a voltage RMSE = 11 mV.Recursive LS methods are used to identify the 1st order impedance of a 940 mAh NMC Li-ion cell over a certain cycling lifespan in [88]. The authors use a second-order EKF, which is designed for state estimation and the model is validated with DST and federal urban driving schedule (FUDS) giving a voltage mean relative error (MRE) lower than 2% for the BoL with an increasing trend over the end of life at about 10%.To cope with the slow change of the parameters that the RLS alone cannot instantaneously capture, authors in [89] use an optimal forgetting factor that tends to ’forget’ the older values on the parameter estimation and give to latest data more influence, usually to incorporate temperature and ageing effects on the cells. In this regard, seven ECMs compete for the most accurate modeling approach, in terms of voltage MRE and RMSE accuracy. The comparison is implemented based on a 10 Ah LFP battery cell and the models are validated with DST and a FUDS showing the lowest absolute and RMS errors for the DP model. The RLS with an optimal forgetting factor is also employed in [90] where the SoC estimation is compared and validated for three different Li-ions. Also, here, the DP model is compared with the Thevenin and is found to have lower voltage and SoC inaccuracies.To further investigate the computational accuracy of the different LS methods on the Li-ion cells, reference [91] proposed an RLS method that decouples the slow and high dynamic areas (for low and higher

Δ
O
C
V
/
Δ
S
o
C

 respectively) of the OCV by employing linear low and high pass filters. A better performance has been achieved compared to the conventional WRLS method. Following this approach, authors in [81] investigate the accuracy of the DP model of an 18650 cylindrical NCA cell based on a decoupled WRLS method. They separate the slow and fast dynamic area and the DP model impedance is created based on the two different observations in time domain. It is seen that the model shows a better performance compared to simple RLS-based method, whereas also, the benefit on the SoC estimation accuracy with the DWRLS method is underlined, without any need for filtering or observers which could potentially decrease the computational efficiency.As a last remark, LS methods have been used in a multi-cell topology for determining the highest impedance among the cells as well. This is achieved in [92] where the RLS method is used to obtain the impedance and the OCV information of each cell and to determine the states and power capability of a battery pack. 4.3. Parameter Extraction with Heuristic OptimizationAn alternative approach on the identification methods that requires the problem’s convexity and appears more suitable for high non-linear and discontinuous functions is based on the heuristic algorithms [93]. Several algorithms have been proposed in the literature, depending on their methodology: evolution-, physics- and swarm-based methods, which respectively include the genetic algorithms (GA), simulated annealing algorithm (SA), particle swarm (PSO), ant colony (ACO), firefly algorithm (FA), grey wolf (GWO), whale optimization algorithm (WOA) and the multi-verse cosmology-based (MVO) optimizations. A comparative study for such methods on various Li-ion ECMs is performed in [11], while characterizing a 32.5 Ah NMC pouch cell. The authors proposed a relationship in the model-to-parameterization approach based on the model’s efficiency and the algorithm’s computational time and accuracy. For the DP model, PSO, GA and then FA showed the highest robustness, whereas PSO requires by far the lowest computation time to converge. It is also the most accurate whereas authors suggest FA for higher-order ECMs due to its superior identification capacity, lacking though on the computational time.The heuristic algorithms have been used depending the study, mostly aiming on the ECM comparison and assessment and not to the identification efficiency. The GA is used in [85] to analyze for an LMO cells with five different ECMs. A DST is performed to estimate the voltage mean absolute error (MAE) of the proposed models, where it is shown that the DP shows the lowest values. Also, in [94] authors examine 12 ECMs of an NMC and LFP with low capacity cylindrical cells. The selected models cover a wide range of ECMs from simple polynomial representation to enhanced self-correcting (ESC) models with two and four states of low-pass filtering, and up to third order with or without hysteresis block. The parametrization of the proposed ECMs is implemented with a multi-swarm particle swarm optimization (MPSO), another heuristic algorithm similar to PSO but modified to improve its global search capability [95]. It is found that the Thevenin ECM with hysteresis (LFP) and without (NMC) can provide the optimal results in terms of voltage ME and RMSE. Also, in [96], authors assess the performance of GA parameterization method on 11 ECMs. The models are checked for accuracy and robustness in terms of parameter fluctuations and inaccuracies of the SoC estimation. The authors showed that increasing the number of equivalent models by more than two brings no benefits as the complexity during parameterization increases along with the estimation error, whereas the EKF cannot overcome this modeling weakness which results in the SoC error becoming increasingly large when using a high-order RC model. Lastly, in [97], authors use a GA to investigate four different modeling approaches of an LFP 10 Ah cell. A crude approximation of the LFP’s dynamics is made with a mathematical combined model, a better performance is achieved with a 2nd order ECM, whereas a single-particle model and a data-driven with support vector machine shown the best accuracy but with significantly increased required computational time.The GA has been preferred in this field of research where structural details of the GA algorithm implementation can be found in [98,99,100]. Nevertheless, PSO compared to GA is faster since it involves no mutation or crossover functions and usually outperforms GA for unconstrained non-linear problems such as Li-ion ECMs [101]. It is being preferred for higher complexity studies such as in identification of certain electrochemical parameters that can significantly change over ageing [102]. Other research use hybrid GA-PSO [103], non-linear regression with PSO [104], and coevolutionary CPSO [105] to enhance the optimization process on state and parameter estimation. The addressed challenges with heuristic methods include the number of parameters that they have to optimize, the respective computational time and memory requirement, the construction of a solid objective function and the robustness of such probabilistic methods within a stable accuracy limit as the results are obtained from a random population, generations and observations [106]. On the other hand they do not require initialization of the parameters and multi-objective functions can be defined to enhance the accuracy and the computational time on problems with several conflicting criteria such as temperature, current rates, ageing etc. [107,108]. Hence in this work, GA and PSO are compared to assess the speed, the robustness and the accuracy on two Li-ions with different characteristics. Since the experiments are held in the BoL and

25


∘


C a single-objective approach is proposed as in [109]. According to literature research, the optimization criterion to define the optimal value can be set with either the mean or their square residual, or the RMS minimization. In this work, a brief comparison of several fitness approaches has shown that the execution time inversely changes with their complexity. Increasing the modeling accuracy has been the merit of selection in this study, and the objective function is hence formulated as the minimization of the total absolute residuals of the fixed-length sampling data sequence, similarly to [110,111]. 4.4. Parameter Extraction with Impedance SpectroscopyDespite the extra hardware testing requirement of the EIS-based models, they can give impedance characterization with the physical meaning of the properties of the materials due to the equally considered, wide frequency range applied to the cells. Compared to the limitation of the pulse current method on the sampling rate and the corresponding frequencies that can be determined during the fitting process [112], impedance results with EIS give analytical in-sight of the individual generated resistances at specific states and temperatures, by relating frequency to the respective processes.In [113], a hybrid characterization procedure is used to model the dynamic behavior of the cell by combining information form the EIS and HPPC responses on SoC, temperature, and current dependencies. The simulated behavior of the LFP 1.2 Ah prismatic cell is adapted according to the BVE, by applying to the model correction factors generated from the differences between the simulated and the experimental voltages, approach that is also examined in [114]. The proposed model achieved a low relative error, tested with a dynamic pulse current and an application specific field-measured profile for frequency regulation purposes. A similar approach that uses EIS and pulse current excitation takes place in [72]. The authors use the impedance spectra to investigate the high-frequency Ohmic, charge-transfer and SEI resistances, while the low-frequency diffusion processes, the corresponding resistances and the overpotentials are characterized by HPPC, as an attempt to overcome the EIS challenges on modeling them. Hereafter, a static model is proposed with focus on the analysis and identification of the most dominant loss mechanisms. In particular, in short pulses (time-constant in range of seconds) overvoltages related to high-frequency components have major importance with approximately 85% on the overall losses, whereas in longer periods (min or hours range) diffusion overpotential is fully built up and equally restricts the performance of the cell. Further detailed analysis on the conduction phenomena occurring in Li-ions and modeling approaches of the diffusions can be found in [61,115].Also, in [116], authors propose seven impedance-based ECMs with a current dependency described by the BVE. The models are tested in a model-in-the-loop environment using real vehicle data obtained in an EV prototype and current pulse tests. Temperature, calendar/cycle ageing as well as C-rate dependences are investigated on the proposed models to assess the state of available power capability of the cells at various SoCs. Results have shown a good voltage performance of the 3rd order CPE model with its accuracy being slightly dropped for either aged or operating close to the SoA limits.Nevertheless, modeling with EIS raises practical challenges for on-board equipment integration and performance at a multi-cell topology level, while the obtained impedance in this study works as a benchmark to compare results acquired from the other numerical methods. 4.5. Parameter Extraction with Kalman Filters Based TechniquesA Kalman filter-based parameter identification has been used in [117] for a 1st order (R-R//C) ECM to assess the modeling accuracy on state of available power, when the BVE non-linear charge-transfer resistance on the current dependency is considered. The results shown a significant improvement on the estimation accuracy compared to the case that charge-transfer resistance is linear and the BVE is neglected. However, as highlighted in [48] assumption made on the constancy of the symmetry factors and the exchange current density over the lifetime and temperature can affect the accuracy estimation in the various conditions. Same authors in [10] incorporate the Arrhenius equation to evaluate the KF accuracy on an LFP when temperature effects on the redox reactions at the electrodes are considered signifying its importance.Furthermore, Kalman filter methods can combine the parameter identification and the state estimation resulting in a system identification approach. The linear barrier of the KF method is surpassed with the Extended KF (EKF) [18], composed of first-order Taylor-series expansions that are used to linearize the non-linear time-invariant Li-ion model. For this purpose dual (DKF) or joint (JKF) Kalman filters may be used by either working in parallel and providing each other information, or by enlarging the model matrices in order to establish higher reliability with the penalty of proportionally increased computational time [118,119,120,121,122].Nejad et al. [19], proposed a dual-EKF approach which combines state and weight filter for SoC and parameter identification, respectively. Both filters can simultaneously operate and feed each other to enhance stability and improve the accuracy. The filters are evaluated on ten ECMs from simple combined model up to 2nd order ECM with hysteresis. The authors conclude that for NMC cells the DP ECM is the optimal choice for ECM parametrization offering the best trade-off between performance and complexity, with RMSE < 10 mV and SoC accuracy with less than RMSE < 1% under various operation temperatures. Alternatively, the one-RC model with hysteresis can be a compromise for chemistries with higher hysteresis effect, as in LFPs. 5. Results, Validations and Discussions 5.1. Resistance and Power Capability 5.1.1. Lower Time-Constant ResistancesIon concentration at the electrode-electrolyte interface builds up as the applied current pulse period is increased which creates further increment on the total resistance and the overpotential between the operating and the open circuit voltage. For a short period, impedance of the cells is kept low as the ion concentration and the diffusion overpotential are not quite developed. This -material and temperature- dependent result is illustrated for both battery cells in Figure 11.It is observed that regardless SoC, current amplitude/direction and pulse duration the LTO produces relatively lower polarization overpotentials compared to NMC cell (around 3 mV for short and around 7 mV for higher pulses considering measurement error of

1.5

 mV, cells connectors and cables are considered to have the same impedance). Nevertheless, for the LTO cell this polarization drop refers to an approximately

50
%

 contribution of the total 100 mV overpotential taking place for a 20 s pulse (at 3 C). For the same conditions but a current rate of 2 C, an approximately

30
%

 contribution on the overall 180 mV polarization is observed for the prismatic NMC. That means, this NMC cell has significantly higher Ohmic, kinetics and mass transport limitations compared to the LTO at the

25


∘


C, which makes the former more suitable for high-energy applications, whereas the latter might be more efficient for high-power demanding applications.If the Ohmic part is subtracted during the applied current, the effects of electrochemical charge-transfer, double layer and diffusion in electrolyte and electrodes are observed without however being possible to clearly distinguish them. Regarding this, the higher frequency processes can be separated from the EIS whereas the overvoltage build-up due to slower processes, can be roughly observed here, while the current is still flowing through the cells, or after removing the applied potential and letting the batteries reach equilibrium, as proposed from Gantenbein et al. [72]. Diffusion overpotential becomes more pronounced at decreased temperatures [50] or increased current rates [28]. On the contrary, despite the Li-ion’s chemical composition Ohmic resistance expresses the inherited resistivity of the materials that hinders the charge-transferring and it is affected by SoC, temperature and lifetime [67]. Hence, the irreversible Joule losses contribution of the Ohmic resistance is the same regardless length of the pulse. 5.1.2. Total ResistancesThe speed of the redox reactions which are taking place in the electrodes and convert chemical to/from electrical energy, the corresponding electrode kinetics, the diffusion coefficient and the mass transports define the power capability of the cells, whereas the applied current is an expression that defines the speed of the reactions at a certain rate [123]. The power capability


P

p
u
l
s
e




|


Δ
t



, the total resistance

R

D
C


 and the corresponding overpotential

Δ

V

D
C



 are obtained from Equations (3) and (4) with the assumption that both Ohmic and polarization processes are included in these results. As described in Equation (6), the current exchange and the symmetry factors can be further obtained. The impedance behaviors at the various current rates are plotted in Figure 12.By increasing the pulse current rate for a certain period, the kinetics of the electrochemical processes speed up due to increased temperature and results in a lower total resistance. Since the Ohmic resistance remains constant, the instantaneous

I

R
0


 and the polarization overpotential between operating and open circuit potential are proportionally increased to the applied current. For illustrative reasons, the charge-discharge behavior is shown at 50% SoC in the 2D plots, whereas the charge is shown in the 3D plots over the various SoCs. It is observed that for

25


∘


C both cells show similar dynamic characteristics for charge and discharge, which makes the assumption on the symmetrical dependence on both anodic and cathodic branches of Equation (6) valid for these cells as well, while low variations in the range of 0.2 mOhms are mostly affected by the increased pulse period. As stated in [17] and also observed in similar LTO power capability studies [124] and in this work, the power capability of storing during charge is higher than delivering during discharge for both cells, and the difference increases proportionally to the current rate. For both chemistries difference lays in the range of a few Watts for current rates up to 1 C, whereas it is highly increased for the LTO at 3 C/8 C current with 25 Watts/85 Watts respectively, and for NMC at 2 C stays around 40 Watt. It can be concluded that the dynamic behavior of the LTO changes for very high current rates, where for 8 C


P

c
h
a
r
g
e


/

P

d
i
s
c
h
a
r
g
e


=
1.23

.As the speed of the energy delivered is affected by the kinetics of the active materials and their interface, it is not possible to obtain the same value at different time periods and applied currents. The measured pulse power capabilities of the cells show that more energy can be transformed as the current rates and their duration increase, which are proportional to the generated overvoltage and diminish due to the total resistance (and the respective heat generation) increase. Comparing the two cells, the lower resistance and overpotential, along with the higher power and current rate capability makes the LTO more favorable for fast charging applications [13]. It should be noted here that a proportional behavior of

R

D
C


 to the

P

p
u
l
s
e


 is observed which come against to what it is expected when the temperature effect is considered. As seen in [19], total resistance has a reverse proportional behavior with the temperature, as the kinetics and the diffusion coefficients are enhanced at such increase, which consequently leads to an inverse behavior of the power. However, it is possibly explained due to the fact that temperature has a greater effect on the total resistance (in the range of 10 mOhms for the LTO) which can drop the power capability remarkably. On the other hand, impedance increase during a pulse with a higher period is at a lower range and is not capable of dropping the power capability, although it comes with the simultaneous increase in the irreversible Joule losses. Precisely, the LTO at a 20 s pulse with a 3 C rate gives approximately 30 W more power than the same 2 s pulse, whereas the respective losses are 6.8 W compared to 5.18 W. For NMC a 2 C pulse for 20 s gives 20 W more power than the 2 s pulse, whereas at 50% SoC we have 14.4 W Joule loss compared to 11.3 W, respectively. On the other hand, for the same power capability (e.g., 150 W) NMC generates approximately 2 times less heat than LTO. Nonetheless, it is concluded that high-power pulses (duration and rate) applications are not optimal for the NMC cell, where LTO is more favorable and capable of feeding up to 8 C charging loads with 450 W and 35 W losses for 10 s at 50% SoC. 5.2. Current Profiles and Voltage ResponsesThe parameter identification of the cells in the time domain are fed to the dual-polarization ECM and the models are assessed with two different load profiles, a WLTC and a HD which can be seen in Figure 13a,b. The models take also initial SoC and temperature as input where they are set same for all cases. It can be seen that the WLTC is divided into two parts, urban and suburban profiles where compared to HD they are more aggressive during discharge, whereas HD has higher current charging rates. In the same figure the measured and the modeled voltage responses are shown for both profiles obtained for NLS method in this case. It can be observed that relative voltage error is below 3% in most cases whereas it is increased for the high discharge area of the suburban WLTC. For the NMC, the relative error of the HD profile stays low throughout the full cycle, while the inherited lower operational nominal voltage of the LTO is responsible for the higher relative error.Other results from the parameter identifications are extracted in a similar way, whereas the relative voltage error for all the methods stays below 4%. 5.3. Discussion of Methodology RobustnessThis section includes a discussion of the robustness of the parameter identification methods. Since the heuristic are based on random generations and are probabilistic approaches, they can converge to the global minimum but within a range of accuracy. The robustness of the methods is investigated over ten consequent times, and the relative errors as well the RMSEs are observed. Since the PSO and the GA have shown similar robustness according to [11], and since the GA has been assessed in various research, PSO is selected here to assess the robustness over ten-time repetitive approximations. As seen in the same research, both algorithms need at least five consecutive re-identification of the parameters to produce a reduplicate voltage RMSE with a probability of 99%. On the contrary, LS and TD do not decline from the estimation as they are derived from direct calculations and minimization of the residuals [125].Figure 14 shows the voltage relative error and RMSEs for the PSO for ten times. It is observed that the variation of the former lays between 1% whereas the mean stays more or less the same for both cells. It is observed however that the RMSEs can deviate up to 5 mV, whereas LTO shows lower RMSE for the WLTC. NMC shows a lower mean and standard deviation for the HD profile which results in the lower RMSE compared to the WLTC.Robustness is seen in terms of performing the optimization algorithms for the several repetitions and estimating the deviation of the mean RMSE (

M

R
M
S
E


) to the best fit (

B

R
M
S
E


) as explained in Equation (10).




r
=
1
−



M

R
M
S
E


−

B

R
M
S
E




B

R
M
S
E







(10)

Lowest voltage error for WLTC is obtained at

P
S
O
#
8

a
n
d

#
9

, for HD

P
S
O
#
4

a
n
d

#
9

 for the LTO and NMC. A 0.9 robustness means that the parameterization method deviates in a voltage

M

R
M
S
E


 approximately 10% from the

B

R
M
S
E


.The influence of the robustness depends on the accuracy of the parameter identification. The Ohmic resistance is used to compare the influence of the discrepancies, as shown in Figure 15a,b. The variations in the approximations are seen in the lower and upper SoC range where the Ohmic resistances varies approximately

Δ

R
0


 = 0.01 mOhms. Regarding only the deviation of the

R
0

 it can be considered negligible, with aprx. 2% total variation. However, deviations do exist in the other parameters where total impedance, time constants and modeling

V

b
a
t
t


 can be affected in a higher degree. To estimate this effect, the mean internal resistance


R

i
n
t


=

R
0

+

R
1

+

R
2


 is calculated over the whole SoC, for each iteration of the PSO, and its deviation from the measured impedance of the EIS is assessed. The accumulative variations of

R

i
n
t


 are up to 8% as it seen in Figure 15c,d for both cells.To assess the accuracy of the PSO against the robustness the iterations are plotted from lowest to highest impedance deviation, and the respective RMSEs of the model are plotted accordingly in Figure 15e–h. However, a correlation between the lowest value of the mean internal resistance to the RMSE cannot be made, as we observe that the lowest RMSE obtained for

P
S
O
#
8

 for LTO under WLTC and

P
S
O
#
4

 under HD profile, whereas the best fit for this cell is obtained for

P
S
O
#
1

. On the other hand, the best fit of the NMC gives the lowest RMSEs for both WLTC and HD (

P
S
O
#
9

), which however is considered to be an arbitrary result. On the other hand, a proportional correlation between the RMSE and the increase of the internal resistance is observed from the curves for both cells when applying a linear regression. The positive rate of change
λ
 denotes the degree of expected inaccuracy as the internal resistance identification trips away from the actual. 5.4. Parameter Identification Comprehensive AssessmentTaking on account the analysis performed so far, the comparison for the off-line parameter identification and the DP ECM modeling can be assessed based on the real-life loading profiles, in terms of accuracy, robustness and computational effort. First, comparisons on accuracy are performed based on the best RMSE obtained from the heuristic algorithms, the analytical approach and the least-square methods. Secondly, robustness is addressed with the deviation of the mean to the best RMSE, considering the minimum number of consecutive repetitions for achieving at least 99% model accuracy [11]. Thirdly, computational efficiency is recording the elapsed identification time of each method. In Figure 16, the relative errors of the DP ECM are shown for the two current profiles in (a) for LTO and (b) for NMC. All the methods but the TD and the GA for the HD can give absolute maximum below 4% errors for the LTO, whereas for the NMC accuracy stays above 97%. The models show good behavior for both profiles with mean relative errors below 1%. The RMSEs are shown in the subfigure (g), where the superiority in modeling accuracy of the PSO over the GA is clear for all cases. Analytical approaches are simple but difficult to catch accurately the impedance deviations and can result in higher inaccuracies. LS-based methods, on the other hand, are accurate and can be compared to the PSO approach. In (c) to (f) the normalized values of the identification methods are presented where 1 denotes the worst and 5 the best. It is seen that the WLTC loading on the LTO cell gives higher accuracy than the HD, where the inverse behavior is observed for the NMC. Robustness and computational time are not affected by the loading profile and remain the same. The scores of identification methods for all cases are shown analytically in Table 5. It is indicated that PSO has the best performance for both cells for WLTC, whereas LS is better for HD and NMC. If the robustness is considered, PSO still remains more accurate in this work whereas the computational efficiency lack is a factor of 2 from LS. 6. ConclusionsParameter identification methods are investigated for the DP ECM of two different anode Li-ion cells. Their nominal capacity is 23 Ah and 43 Ah respectively and they are optimal for either power or energy electromotive applications. A comprehensive research is first performed to investigate the identification methods that are used for off-line modeling. Electrical characterization methods are presented and physical investigation on the parameterization of the ECM based on frequency domain measurements is performed.As a first step, Li-ions are experimentally tested under standardized procedures to assess their voltage to current response as well as impedance and discharge capacity capability at

25


∘


C. Furthermore, the hysteresis effect in both cells showed a highest value of 20 mV at the mid-SoCs, whereas it stays less than 30 mV in the high non-linear areas. For this reason, it is neglected from the dynamic modeling, for which a DP ECM approach has been followed due to its high accuracy shown in several research with an additional low computational effort. A straightforward coulomb counting method is used to estimate the SoC in the ECM, where the initial SoC has been manually adapted.Additionally, three main parameterization methods are compared in discrete-time, with analytical equations (TD), least-square-based methods (LS) and heuristic optimization (GA and PSO). The generated models are validated with WLTC urban and suburban profiles, and a heavy-duty dynamic profile. The assessment is implemented in terms of modeling accuracy, robustness and required computational time. The modeling accuracy and the computational time are direct measurements between the simulated and the experimental voltage responses in terms of mean voltage RE and RMSE in one hand, and convergence of the parameterization method on the other. As for the robustness, it is estimated based on a 10-times repetition of the methods, where the respective variation of the ECM parameters (with focus on the Ohmic and the internal resistances) and their effect on the MREs and RMSEs are compared and showed a good agreement with most cases been less than approximately 3% and a voltage RMSE lower than 30 mV. The TD model showed the less accuracy in both. The PSO showed the lowest voltage deviations for the LTO at both loading profiles whereas for the NMC it has the best accuracy for the WLTC but not for HD. As the modeling accuracy and the robustness are concerned, PSO is the optimal approach for off-line identification. Nevertheless, work on the algorithm should be performed to reduce computational (and memory) requirements to apply the method in microcontroller and online identification.Lastly, the Ohmic resistance obtained from the impedance spectra with EIS technique at either cross-section with real axis and at 100 Hz sampling frequency, showed a good relationship to the LS method and the heuristic algorithms. However, a comparison of the total internal resistance obtained from the PSO showed that a 0.01 mOhms variation on the Ohmic (1% to 2% depending the chemistry) and up to an accumulative 8% variation on the total internal resistance can be occur. However, the increasing RMSE of the method showed a positive correlation with that internal resistance increase and it is chemistry dependent.Next steps may include dynamic modeling and comparisons with frequency domain on the same merits to further incorporate the physical behavior of the cells. Also, online adaptation of the PSO and the LS for state estimations investigated for several cell chemistries. A universal algorithm for parameter identification and state estimation despite Li-ion technology is also under research. Regarding the DP ECM, thermal and ageing branches are generated to thoroughly characterize the cells which are going to be presented in future work.
